

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Thermal-Quantum-Numerov-Solver Documentation &mdash; Thermal-Quantum-Numerov-Solver 1.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=03e43079" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=9edc463e" />

  
      <script src="_static/jquery.js?v=5d32c60e"></script>
      <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="_static/documentation_options.js?v=f2a433a1"></script>
      <script src="_static/doctools.js?v=fd6eb6e6"></script>
      <script src="_static/sphinx_highlight.js?v=6ffebe34"></script>
      <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}}</script>
      <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@4/tex-mml-chtml.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="#" class="icon icon-home">
            Thermal-Quantum-Numerov-Solver
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <!-- Local TOC -->
              <div class="local-toc"><ul>
<li><a class="reference internal" href="#">Thermal-Quantum-Numerov-Solver Documentation</a><ul>
<li><a class="reference internal" href="#module-src.models.config">Models (Data &amp; Physics)</a><ul>
<li><a class="reference internal" href="#src.models.config.NumericalConfig"><code class="docutils literal notranslate"><span class="pre">NumericalConfig</span></code></a><ul>
<li><a class="reference internal" href="#src.models.config.NumericalConfig.n_points"><code class="docutils literal notranslate"><span class="pre">NumericalConfig.n_points</span></code></a></li>
<li><a class="reference internal" href="#src.models.config.NumericalConfig.x_min"><code class="docutils literal notranslate"><span class="pre">NumericalConfig.x_min</span></code></a></li>
<li><a class="reference internal" href="#src.models.config.NumericalConfig.x_max"><code class="docutils literal notranslate"><span class="pre">NumericalConfig.x_max</span></code></a></li>
<li><a class="reference internal" href="#src.models.config.NumericalConfig.convergence_tolerance"><code class="docutils literal notranslate"><span class="pre">NumericalConfig.convergence_tolerance</span></code></a></li>
<li><a class="reference internal" href="#id0"><code class="docutils literal notranslate"><span class="pre">NumericalConfig.convergence_tolerance</span></code></a></li>
<li><a class="reference internal" href="#id1"><code class="docutils literal notranslate"><span class="pre">NumericalConfig.n_points</span></code></a></li>
<li><a class="reference internal" href="#id2"><code class="docutils literal notranslate"><span class="pre">NumericalConfig.x_max</span></code></a></li>
<li><a class="reference internal" href="#id3"><code class="docutils literal notranslate"><span class="pre">NumericalConfig.x_min</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#src.models.config.PhysicsConfig"><code class="docutils literal notranslate"><span class="pre">PhysicsConfig</span></code></a><ul>
<li><a class="reference internal" href="#src.models.config.PhysicsConfig.hbar"><code class="docutils literal notranslate"><span class="pre">PhysicsConfig.hbar</span></code></a></li>
<li><a class="reference internal" href="#src.models.config.PhysicsConfig.mass"><code class="docutils literal notranslate"><span class="pre">PhysicsConfig.mass</span></code></a></li>
<li><a class="reference internal" href="#src.models.config.PhysicsConfig.kb"><code class="docutils literal notranslate"><span class="pre">PhysicsConfig.kb</span></code></a></li>
<li><a class="reference internal" href="#src.models.config.PhysicsConfig.well_width"><code class="docutils literal notranslate"><span class="pre">PhysicsConfig.well_width</span></code></a></li>
<li><a class="reference internal" href="#id4"><code class="docutils literal notranslate"><span class="pre">PhysicsConfig.hbar</span></code></a></li>
<li><a class="reference internal" href="#id5"><code class="docutils literal notranslate"><span class="pre">PhysicsConfig.kb</span></code></a></li>
<li><a class="reference internal" href="#id6"><code class="docutils literal notranslate"><span class="pre">PhysicsConfig.mass</span></code></a></li>
<li><a class="reference internal" href="#id7"><code class="docutils literal notranslate"><span class="pre">PhysicsConfig.well_width</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#src.models.potentials.BasePotential"><code class="docutils literal notranslate"><span class="pre">BasePotential</span></code></a><ul>
<li><a class="reference internal" href="#src.models.potentials.BasePotential.config"><code class="docutils literal notranslate"><span class="pre">BasePotential.config</span></code></a></li>
<li><a class="reference internal" href="#id8"><code class="docutils literal notranslate"><span class="pre">BasePotential.config</span></code></a></li>
<li><a class="reference internal" href="#src.models.potentials.BasePotential.evaluate"><code class="docutils literal notranslate"><span class="pre">BasePotential.evaluate()</span></code></a></li>
<li><a class="reference internal" href="#src.models.potentials.BasePotential.get_domain"><code class="docutils literal notranslate"><span class="pre">BasePotential.get_domain()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#src.models.potentials.FiniteSquareWell"><code class="docutils literal notranslate"><span class="pre">FiniteSquareWell</span></code></a><ul>
<li><a class="reference internal" href="#src.models.potentials.FiniteSquareWell.evaluate"><code class="docutils literal notranslate"><span class="pre">FiniteSquareWell.evaluate()</span></code></a></li>
<li><a class="reference internal" href="#src.models.potentials.FiniteSquareWell.get_domain"><code class="docutils literal notranslate"><span class="pre">FiniteSquareWell.get_domain()</span></code></a></li>
<li><a class="reference internal" href="#src.models.potentials.FiniteSquareWell.v0"><code class="docutils literal notranslate"><span class="pre">FiniteSquareWell.v0</span></code></a></li>
<li><a class="reference internal" href="#src.models.potentials.FiniteSquareWell.width"><code class="docutils literal notranslate"><span class="pre">FiniteSquareWell.width</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#src.models.potentials.HarmonicPotential"><code class="docutils literal notranslate"><span class="pre">HarmonicPotential</span></code></a><ul>
<li><a class="reference internal" href="#src.models.potentials.HarmonicPotential.center"><code class="docutils literal notranslate"><span class="pre">HarmonicPotential.center</span></code></a></li>
<li><a class="reference internal" href="#src.models.potentials.HarmonicPotential.evaluate"><code class="docutils literal notranslate"><span class="pre">HarmonicPotential.evaluate()</span></code></a></li>
<li><a class="reference internal" href="#src.models.potentials.HarmonicPotential.get_domain"><code class="docutils literal notranslate"><span class="pre">HarmonicPotential.get_domain()</span></code></a></li>
<li><a class="reference internal" href="#src.models.potentials.HarmonicPotential.omega"><code class="docutils literal notranslate"><span class="pre">HarmonicPotential.omega</span></code></a></li>
<li><a class="reference internal" href="#src.models.potentials.HarmonicPotential.v0_limit"><code class="docutils literal notranslate"><span class="pre">HarmonicPotential.v0_limit</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#src.models.potentials.InfiniteSquareWell"><code class="docutils literal notranslate"><span class="pre">InfiniteSquareWell</span></code></a><ul>
<li><a class="reference internal" href="#src.models.potentials.InfiniteSquareWell.evaluate"><code class="docutils literal notranslate"><span class="pre">InfiniteSquareWell.evaluate()</span></code></a></li>
<li><a class="reference internal" href="#src.models.potentials.InfiniteSquareWell.get_domain"><code class="docutils literal notranslate"><span class="pre">InfiniteSquareWell.get_domain()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#src.models.potentials.VShapedPotential"><code class="docutils literal notranslate"><span class="pre">VShapedPotential</span></code></a><ul>
<li><a class="reference internal" href="#src.models.potentials.VShapedPotential.center"><code class="docutils literal notranslate"><span class="pre">VShapedPotential.center</span></code></a></li>
<li><a class="reference internal" href="#src.models.potentials.VShapedPotential.evaluate"><code class="docutils literal notranslate"><span class="pre">VShapedPotential.evaluate()</span></code></a></li>
<li><a class="reference internal" href="#src.models.potentials.VShapedPotential.get_domain"><code class="docutils literal notranslate"><span class="pre">VShapedPotential.get_domain()</span></code></a></li>
<li><a class="reference internal" href="#src.models.potentials.VShapedPotential.slope"><code class="docutils literal notranslate"><span class="pre">VShapedPotential.slope</span></code></a></li>
<li><a class="reference internal" href="#src.models.potentials.VShapedPotential.v0_limit"><code class="docutils literal notranslate"><span class="pre">VShapedPotential.v0_limit</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#module-src.models.states">Domain Models</a><ul>
<li><a class="reference internal" href="#src.models.states.QuantumSystem"><code class="docutils literal notranslate"><span class="pre">QuantumSystem</span></code></a><ul>
<li><a class="reference internal" href="#src.models.states.QuantumSystem.energies"><code class="docutils literal notranslate"><span class="pre">QuantumSystem.energies</span></code></a></li>
<li><a class="reference internal" href="#src.models.states.QuantumSystem.get_probability_density"><code class="docutils literal notranslate"><span class="pre">QuantumSystem.get_probability_density()</span></code></a></li>
<li><a class="reference internal" href="#src.models.states.QuantumSystem.get_state"><code class="docutils literal notranslate"><span class="pre">QuantumSystem.get_state()</span></code></a></li>
<li><a class="reference internal" href="#src.models.states.QuantumSystem.ground_state_energy"><code class="docutils literal notranslate"><span class="pre">QuantumSystem.ground_state_energy</span></code></a></li>
<li><a class="reference internal" href="#src.models.states.QuantumSystem.n_states"><code class="docutils literal notranslate"><span class="pre">QuantumSystem.n_states</span></code></a></li>
<li><a class="reference internal" href="#src.models.states.QuantumSystem.potential"><code class="docutils literal notranslate"><span class="pre">QuantumSystem.potential</span></code></a></li>
<li><a class="reference internal" href="#src.models.states.QuantumSystem.wavefunctions"><code class="docutils literal notranslate"><span class="pre">QuantumSystem.wavefunctions</span></code></a></li>
<li><a class="reference internal" href="#src.models.states.QuantumSystem.x_grid"><code class="docutils literal notranslate"><span class="pre">QuantumSystem.x_grid</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#module-src.core.solvers">Core Engine (Solvers)</a><ul>
<li><a class="reference internal" href="#mathematical-background">Mathematical Background</a></li>
<li><a class="reference internal" href="#src.core.solvers.BaseSolver"><code class="docutils literal notranslate"><span class="pre">BaseSolver</span></code></a><ul>
<li><a class="reference internal" href="#src.core.solvers.BaseSolver.solve"><code class="docutils literal notranslate"><span class="pre">BaseSolver.solve()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#src.core.solvers.NumerovSolver"><code class="docutils literal notranslate"><span class="pre">NumerovSolver</span></code></a><ul>
<li><a class="reference internal" href="#src.core.solvers.NumerovSolver.config"><code class="docutils literal notranslate"><span class="pre">NumerovSolver.config</span></code></a></li>
<li><a class="reference internal" href="#id9"><code class="docutils literal notranslate"><span class="pre">NumerovSolver.config</span></code></a></li>
<li><a class="reference internal" href="#src.core.solvers.NumerovSolver.solve"><code class="docutils literal notranslate"><span class="pre">NumerovSolver.solve()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#module-src.models.statistics">Particle Statistics</a><ul>
<li><a class="reference internal" href="#background">Background</a></li>
<li><a class="reference internal" href="#src.models.statistics.ParticleType"><code class="docutils literal notranslate"><span class="pre">ParticleType</span></code></a><ul>
<li><a class="reference internal" href="#src.models.statistics.ParticleType.BOLTZMANN"><code class="docutils literal notranslate"><span class="pre">ParticleType.BOLTZMANN</span></code></a></li>
<li><a class="reference internal" href="#src.models.statistics.ParticleType.BOSON"><code class="docutils literal notranslate"><span class="pre">ParticleType.BOSON</span></code></a></li>
<li><a class="reference internal" href="#src.models.statistics.ParticleType.FERMION"><code class="docutils literal notranslate"><span class="pre">ParticleType.FERMION</span></code></a></li>
<li><a class="reference internal" href="#src.models.statistics.ParticleType.SPIN_HALF"><code class="docutils literal notranslate"><span class="pre">ParticleType.SPIN_HALF</span></code></a></li>
<li><a class="reference internal" href="#src.models.statistics.ParticleType.SPIN_ONE"><code class="docutils literal notranslate"><span class="pre">ParticleType.SPIN_ONE</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#design-solid">Design (SOLID)</a></li>
<li><a class="reference internal" href="#mathematical-summary">Mathematical Summary</a></li>
<li><a class="reference internal" href="#src.core.statistics.ThermalEngine"><code class="docutils literal notranslate"><span class="pre">ThermalEngine</span></code></a><ul>
<li><a class="reference internal" href="#src.core.statistics.ThermalEngine.calculate_pair_density"><code class="docutils literal notranslate"><span class="pre">ThermalEngine.calculate_pair_density()</span></code></a></li>
<li><a class="reference internal" href="#src.core.statistics.ThermalEngine.calculate_thermal_density"><code class="docutils literal notranslate"><span class="pre">ThermalEngine.calculate_thermal_density()</span></code></a></li>
<li><a class="reference internal" href="#src.core.statistics.ThermalEngine.get_pair_density"><code class="docutils literal notranslate"><span class="pre">ThermalEngine.get_pair_density()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#module-src.visualization.plotters">Visualisation</a><ul>
<li><a class="reference internal" href="#design-separation-of-concerns">Design: Separation of Concerns</a></li>
<li><a class="reference internal" href="#extensibility-notes">Extensibility notes</a></li>
<li><a class="reference internal" href="#src.visualization.plotters.QuantumPlotter"><code class="docutils literal notranslate"><span class="pre">QuantumPlotter</span></code></a><ul>
<li><a class="reference internal" href="#src.visualization.plotters.QuantumPlotter.plot_pair_density_3d"><code class="docutils literal notranslate"><span class="pre">QuantumPlotter.plot_pair_density_3d()</span></code></a></li>
<li><a class="reference internal" href="#src.visualization.plotters.QuantumPlotter.plot_pair_density_heatmap"><code class="docutils literal notranslate"><span class="pre">QuantumPlotter.plot_pair_density_heatmap()</span></code></a></li>
<li><a class="reference internal" href="#src.visualization.plotters.QuantumPlotter.plot_thermal_density"><code class="docutils literal notranslate"><span class="pre">QuantumPlotter.plot_thermal_density()</span></code></a></li>
<li><a class="reference internal" href="#src.visualization.plotters.QuantumPlotter.plot_wavefunctions"><code class="docutils literal notranslate"><span class="pre">QuantumPlotter.plot_wavefunctions()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="#">Thermal-Quantum-Numerov-Solver</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="#" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Thermal-Quantum-Numerov-Solver Documentation</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/index.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="thermal-quantum-numerov-solver-documentation">
<h1>Thermal-Quantum-Numerov-Solver Documentation<a class="headerlink" href="#thermal-quantum-numerov-solver-documentation" title="Link to this heading"></a></h1>
<div class="toctree-wrapper compound">
</div>
<section id="module-src.models.config">
<span id="models-data-physics"></span><h2>Models (Data &amp; Physics)<a class="headerlink" href="#module-src.models.config" title="Link to this heading"></a></h2>
<p>Configuration dataclasses for dimensionless Schrödinger simulations.</p>
<p>The legacy notebook uses reduced (dimensionless) units where:
- <span class="math notranslate nohighlight">\(\hbar = 1\)</span>
- <span class="math notranslate nohighlight">\(m = 0.5\)</span>
- <span class="math notranslate nohighlight">\(k_B = 1\)</span>
- <span class="math notranslate nohighlight">\(L = \pi\)</span></p>
<p>These values make the infinite-well reference spectrum satisfy
<span class="math notranslate nohighlight">\(E_n = n^2\)</span> in units of the ground-state energy scale.</p>
<dl class="py class">
<dt class="sig sig-object py" id="src.models.config.NumericalConfig">
<span class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></span><span class="sig-prename descclassname"><span class="pre">src.models.config.</span></span><span class="sig-name descname"><span class="pre">NumericalConfig</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_points</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">600</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x_min</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">-1.5707963267948966</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x_max</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">4.71238898038469</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">convergence_tolerance</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.0001</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/models/config.html#NumericalConfig"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.models.config.NumericalConfig" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Numerical discretization and convergence controls in reduced units.</p>
<p>The default spatial interval reproduces the legacy grid construction:
<span class="math notranslate nohighlight">\(x \in [-\pi/2,\, 3\pi/2]\)</span> with 600 points. Convergence tolerance is the
dimensionless threshold used for thermal-sum stopping criteria.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="src.models.config.NumericalConfig.n_points">
<span class="sig-name descname"><span class="pre">n_points</span></span><a class="headerlink" href="#src.models.config.NumericalConfig.n_points" title="Link to this definition"></a></dt>
<dd><p>Total number of grid points for the spatial discretization.
Dimensionless count (unitless). Default is 600.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="src.models.config.NumericalConfig.x_min">
<span class="sig-name descname"><span class="pre">x_min</span></span><a class="headerlink" href="#src.models.config.NumericalConfig.x_min" title="Link to this definition"></a></dt>
<dd><p>Left boundary of the spatial domain in dimensionless length
units. Default is <span class="math notranslate nohighlight">\(-\pi/2\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="src.models.config.NumericalConfig.x_max">
<span class="sig-name descname"><span class="pre">x_max</span></span><a class="headerlink" href="#src.models.config.NumericalConfig.x_max" title="Link to this definition"></a></dt>
<dd><p>Right boundary of the spatial domain in dimensionless length
units. Default is <span class="math notranslate nohighlight">\(3\pi/2\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="src.models.config.NumericalConfig.convergence_tolerance">
<span class="sig-name descname"><span class="pre">convergence_tolerance</span></span><a class="headerlink" href="#src.models.config.NumericalConfig.convergence_tolerance" title="Link to this definition"></a></dt>
<dd><p>Maximum allowed absolute change in consecutive
thermal-density estimates, in dimensionless probability-density
units. Default is <span class="math notranslate nohighlight">\(10^{-4}\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id0">
<span class="sig-name descname"><span class="pre">convergence_tolerance</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></span><a class="headerlink" href="#id0" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id1">
<span class="sig-name descname"><span class="pre">n_points</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></span><a class="headerlink" href="#id1" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id2">
<span class="sig-name descname"><span class="pre">x_max</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></span><a class="headerlink" href="#id2" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id3">
<span class="sig-name descname"><span class="pre">x_min</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></span><a class="headerlink" href="#id3" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="src.models.config.PhysicsConfig">
<span class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></span><span class="sig-prename descclassname"><span class="pre">src.models.config.</span></span><span class="sig-name descname"><span class="pre">PhysicsConfig</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hbar</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mass</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kb</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">well_width</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">3.141592653589793</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/models/config.html#PhysicsConfig"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.models.config.PhysicsConfig" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Physical constants in dimensionless units from the legacy prototype.</p>
<p>The values match the normalization used in
legacy/research_prototype.ipynb so that the 1D infinite square-well
reference has energies <span class="math notranslate nohighlight">\(E_n = n^2\)</span>.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="src.models.config.PhysicsConfig.hbar">
<span class="sig-name descname"><span class="pre">hbar</span></span><a class="headerlink" href="#src.models.config.PhysicsConfig.hbar" title="Link to this definition"></a></dt>
<dd><p>Reduced Planck constant in dimensionless units. Default is 1.0.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="src.models.config.PhysicsConfig.mass">
<span class="sig-name descname"><span class="pre">mass</span></span><a class="headerlink" href="#src.models.config.PhysicsConfig.mass" title="Link to this definition"></a></dt>
<dd><p>Particle mass in dimensionless units. Default is 0.5, which
enforces <span class="math notranslate nohighlight">\(\hbar^2/(2m)=1\)</span> when <cite>hbar=1</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="src.models.config.PhysicsConfig.kb">
<span class="sig-name descname"><span class="pre">kb</span></span><a class="headerlink" href="#src.models.config.PhysicsConfig.kb" title="Link to this definition"></a></dt>
<dd><p>Boltzmann constant in dimensionless thermal units. Default is 1.0,
so reduced temperature is directly represented as <span class="math notranslate nohighlight">\(t = k_B T\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="src.models.config.PhysicsConfig.well_width">
<span class="sig-name descname"><span class="pre">well_width</span></span><a class="headerlink" href="#src.models.config.PhysicsConfig.well_width" title="Link to this definition"></a></dt>
<dd><p>Characteristic well width <span class="math notranslate nohighlight">\(L\)</span> in dimensionless length units.
Default is <span class="math notranslate nohighlight">\(\pi\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id4">
<span class="sig-name descname"><span class="pre">hbar</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></span><a class="headerlink" href="#id4" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id5">
<span class="sig-name descname"><span class="pre">kb</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></span><a class="headerlink" href="#id5" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id6">
<span class="sig-name descname"><span class="pre">mass</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></span><a class="headerlink" href="#id6" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id7">
<span class="sig-name descname"><span class="pre">well_width</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></span><a class="headerlink" href="#id7" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<p id="module-src.models.potentials">Abstract base class and concrete implementations for 1D quantum potentials.</p>
<p>This module defines the <code class="docutils literal notranslate"><span class="pre">BasePotential</span></code> interface and four concrete
subclasses that faithfully reproduce the potential functions found in
<code class="docutils literal notranslate"><span class="pre">legacy/research_prototype.ipynb</span></code>:</p>
<ul class="simple">
<li><p><a class="reference internal" href="#src.models.potentials.InfiniteSquareWell" title="src.models.potentials.InfiniteSquareWell"><code class="xref py py-class docutils literal notranslate"><span class="pre">InfiniteSquareWell</span></code></a> — Analytical infinite-barrier box.</p></li>
<li><p><a class="reference internal" href="#src.models.potentials.FiniteSquareWell" title="src.models.potentials.FiniteSquareWell"><code class="xref py py-class docutils literal notranslate"><span class="pre">FiniteSquareWell</span></code></a>   — Flat-bottom well with finite barriers.</p></li>
<li><p><a class="reference internal" href="#src.models.potentials.HarmonicPotential" title="src.models.potentials.HarmonicPotential"><code class="xref py py-class docutils literal notranslate"><span class="pre">HarmonicPotential</span></code></a>  — Truncated harmonic oscillator (parabolic).</p></li>
<li><p><a class="reference internal" href="#src.models.potentials.VShapedPotential" title="src.models.potentials.VShapedPotential"><code class="xref py py-class docutils literal notranslate"><span class="pre">VShapedPotential</span></code></a>   — Truncated V-shape (linear) potential.</p></li>
</ul>
<p>All subclasses accept a <a class="reference internal" href="#src.models.config.PhysicsConfig" title="src.models.config.PhysicsConfig"><code class="xref py py-class docutils literal notranslate"><span class="pre">PhysicsConfig</span></code></a> object
for their physical constants, enforcing Dependency Injection and eliminating
global-constant coupling.</p>
<dl class="py class">
<dt class="sig sig-object py" id="src.models.potentials.BasePotential">
<span class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></span><span class="sig-prename descclassname"><span class="pre">src.models.potentials.</span></span><span class="sig-name descname"><span class="pre">BasePotential</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#src.models.config.PhysicsConfig" title="src.models.config.PhysicsConfig"><span class="pre">PhysicsConfig</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/models/potentials.html#BasePotential"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.models.potentials.BasePotential" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">ABC</span></code></p>
<p>Abstract interface for all 1D quantum potential definitions.</p>
<p>Every potential that participates in the Numerov eigenvalue pipeline must
implement this contract.  The <code class="xref py py-class docutils literal notranslate"><span class="pre">NumerovSolver</span></code>
depends <em>only</em> on this interface, so new geometries (e.g. a double well)
can be added in a new subclass without ever modifying the solver — in
strict compliance with the Open-Closed Principle.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>config</strong> – Frozen dataclass holding the dimensionless physical constants
(<code class="docutils literal notranslate"><span class="pre">hbar</span></code>, <code class="docutils literal notranslate"><span class="pre">mass</span></code>, <code class="docutils literal notranslate"><span class="pre">kb</span></code>, <code class="docutils literal notranslate"><span class="pre">well_width</span></code>) used throughout the
simulation.  Defaults to the standard reduced-unit set
(<code class="docutils literal notranslate"><span class="pre">hbar=1</span></code>, <code class="docutils literal notranslate"><span class="pre">mass=0.5</span></code>, <code class="docutils literal notranslate"><span class="pre">L=pi</span></code>) that makes the infinite-well
spectrum satisfy <span class="math notranslate nohighlight">\(E_n = n^2\)</span>.</p>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="src.models.potentials.BasePotential.config">
<span class="sig-name descname"><span class="pre">config</span></span><a class="headerlink" href="#src.models.potentials.BasePotential.config" title="Link to this definition"></a></dt>
<dd><p>Read-only reference to the injected <code class="xref py py-class docutils literal notranslate"><span class="pre">PhysicsConfig</span></code>.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="id8">
<span class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">config</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#src.models.config.PhysicsConfig" title="src.models.config.PhysicsConfig"><span class="pre">PhysicsConfig</span></a></span><a class="headerlink" href="#id8" title="Link to this definition"></a></dt>
<dd><p>The injected physics constants, read-only.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#src.models.config.PhysicsConfig" title="src.models.config.PhysicsConfig">PhysicsConfig</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="src.models.potentials.BasePotential.evaluate">
<span class="property"><span class="k"><span class="pre">abstractmethod</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">evaluate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">float64</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">float64</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/src/models/potentials.html#BasePotential.evaluate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.models.potentials.BasePotential.evaluate" title="Link to this definition"></a></dt>
<dd><p>Evaluates the potential energy <span class="math notranslate nohighlight">\(V(x)\)</span> at each grid point.</p>
<p>This is the primary contract method consumed by the Numerov solver.
All values are returned in dimensionless energy units of <span class="math notranslate nohighlight">\(E_1\)</span>,
where <span class="math notranslate nohighlight">\(E_1 = \hbar^2 / (2m)\)</span> with the defaults <code class="docutils literal notranslate"><span class="pre">hbar=1</span></code>,
<code class="docutils literal notranslate"><span class="pre">mass=0.5</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x</strong> – 1D array of spatial coordinates in dimensionless length units
(e.g. <span class="math notranslate nohighlight">\(x/L\)</span> or literal position when <span class="math notranslate nohighlight">\(L = \pi\)</span>).</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>1D float64 array with the same shape as <code class="docutils literal notranslate"><span class="pre">x</span></code> containing
<span class="math notranslate nohighlight">\(V(x)\)</span> values.  Barrier regions may contain <code class="docutils literal notranslate"><span class="pre">np.inf</span></code>
for infinite-wall geometries.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="src.models.potentials.BasePotential.get_domain">
<span class="property"><span class="k"><span class="pre">abstractmethod</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">get_domain</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/src/models/potentials.html#BasePotential.get_domain"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.models.potentials.BasePotential.get_domain" title="Link to this definition"></a></dt>
<dd><p>Returns the recommended spatial domain <span class="math notranslate nohighlight">\([x_{min}, x_{max}]\)</span>.</p>
<p>The Numerov solver calls this method to build the spatial grid without
any hardcoded geometry knowledge.  The domain should comfortably
contain both the classically allowed region and (for finite barriers)
the evanescent tunnelling tails.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>A <code class="docutils literal notranslate"><span class="pre">(x_min,</span> <span class="pre">x_max)</span></code> tuple in dimensionless length units.</p>
</dd>
</dl>
<p class="rubric">Example</p>
<p>A finite well of width <span class="math notranslate nohighlight">\(L = \pi\)</span> returns:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">well</span> <span class="o">=</span> <span class="n">FiniteSquareWell</span><span class="p">(</span><span class="n">v0</span><span class="o">=</span><span class="mf">10.0</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="n">math</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">well</span><span class="o">.</span><span class="n">get_domain</span><span class="p">()</span>
<span class="go">(-1.5707963267948966, 4.71238898038469)</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="src.models.potentials.FiniteSquareWell">
<span class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></span><span class="sig-prename descclassname"><span class="pre">src.models.potentials.</span></span><span class="sig-name descname"><span class="pre">FiniteSquareWell</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">v0</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">width</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">config</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#src.models.config.PhysicsConfig" title="src.models.config.PhysicsConfig"><span class="pre">PhysicsConfig</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/models/potentials.html#FiniteSquareWell"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.models.potentials.FiniteSquareWell" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#src.models.potentials.BasePotential" title="src.models.potentials.BasePotential"><code class="xref py py-class docutils literal notranslate"><span class="pre">BasePotential</span></code></a></p>
<p>Finite square-well potential with flat barriers.</p>
<p>Faithfully reproduces <code class="docutils literal notranslate"><span class="pre">get_potential(x,</span> <span class="pre">V0,</span> <span class="pre">well_width)</span></code> from
<code class="docutils literal notranslate"><span class="pre">legacy/research_prototype.ipynb</span></code>.</p>
<p>The potential is defined as:</p>
<div class="math notranslate nohighlight">
\[\begin{split}V(x) =
\begin{cases}
    0    &amp; \text{if } 0 \le x \le w \\
    V_0  &amp; \text{otherwise}
\end{cases}\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(w\)</span> is the <code class="docutils literal notranslate"><span class="pre">width</span></code> parameter and <span class="math notranslate nohighlight">\(V_0\)</span> is the
barrier height.</p>
<p>The returned domain adds a half-width margin on the left and a
full-width margin on the right — identical to the legacy constants
<code class="docutils literal notranslate"><span class="pre">X_MIN</span> <span class="pre">=</span> <span class="pre">-L/2</span></code>, <code class="docutils literal notranslate"><span class="pre">X_MAX</span> <span class="pre">=</span> <span class="pre">3L/2</span></code> — to capture the evanescent
tunnelling tails that extend into the barrier region.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>v0</strong> – Barrier height in dimensionless energy units of <span class="math notranslate nohighlight">\(E_1\)</span>.
The legacy study uses <code class="docutils literal notranslate"><span class="pre">v0</span> <span class="pre">∈</span> <span class="pre">{10,</span> <span class="pre">50,</span> <span class="pre">1000}</span></code>.</p></li>
<li><p><strong>width</strong> – Well width in dimensionless length units.  Defaults to
<code class="docutils literal notranslate"><span class="pre">config.well_width</span></code> (i.e. <span class="math notranslate nohighlight">\(\pi\)</span>) when <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p></li>
<li><p><strong>config</strong> – Physics constants.  Reads <code class="docutils literal notranslate"><span class="pre">well_width</span></code> as the fallback
when <code class="docutils literal notranslate"><span class="pre">width</span></code> is not provided.</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – If <code class="docutils literal notranslate"><span class="pre">v0</span> <span class="pre">&lt;</span> <span class="pre">0</span></code> or <code class="docutils literal notranslate"><span class="pre">width</span> <span class="pre">&lt;=</span> <span class="pre">0</span></code>.</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">well</span> <span class="o">=</span> <span class="n">FiniteSquareWell</span><span class="p">(</span><span class="n">v0</span><span class="o">=</span><span class="mf">10.0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">+</span> <span class="mf">0.5</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">well</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="go">array([10. ,  0. ,  0. ,  0. , 10. ])</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="src.models.potentials.FiniteSquareWell.evaluate">
<span class="sig-name descname"><span class="pre">evaluate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">float64</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">float64</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/src/models/potentials.html#FiniteSquareWell.evaluate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.models.potentials.FiniteSquareWell.evaluate" title="Link to this definition"></a></dt>
<dd><p>Returns <span class="math notranslate nohighlight">\(V(x) = 0\)</span> inside <span class="math notranslate nohighlight">\([0, w]\)</span>, <span class="math notranslate nohighlight">\(V_0\)</span> outside.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x</strong> – 1D array of spatial coordinates in dimensionless length units.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Float64 array of the same shape as <code class="docutils literal notranslate"><span class="pre">x</span></code>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="src.models.potentials.FiniteSquareWell.get_domain">
<span class="sig-name descname"><span class="pre">get_domain</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/src/models/potentials.html#FiniteSquareWell.get_domain"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.models.potentials.FiniteSquareWell.get_domain" title="Link to this definition"></a></dt>
<dd><p>Returns the extended domain <span class="math notranslate nohighlight">\([-w/2,\, 3w/2]\)</span>.</p>
<p>The half-width left margin and full-width right margin replicate the
legacy grid <code class="docutils literal notranslate"><span class="pre">X_MIN</span> <span class="pre">=</span> <span class="pre">-L/2</span></code>, <code class="docutils literal notranslate"><span class="pre">X_MAX</span> <span class="pre">=</span> <span class="pre">3L/2</span></code>, ensuring sufficient
room for the evanescent wave tails to decay to zero.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The tuple <code class="docutils literal notranslate"><span class="pre">(-width/2,</span> <span class="pre">3*width/2)</span></code>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="src.models.potentials.FiniteSquareWell.v0">
<span class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">v0</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></span><a class="headerlink" href="#src.models.potentials.FiniteSquareWell.v0" title="Link to this definition"></a></dt>
<dd><p>Barrier height in dimensionless energy units.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="src.models.potentials.FiniteSquareWell.width">
<span class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">width</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></span><a class="headerlink" href="#src.models.potentials.FiniteSquareWell.width" title="Link to this definition"></a></dt>
<dd><p>Well width in dimensionless length units.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="src.models.potentials.HarmonicPotential">
<span class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></span><span class="sig-prename descclassname"><span class="pre">src.models.potentials.</span></span><span class="sig-name descname"><span class="pre">HarmonicPotential</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">omega</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">2.2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">v0_limit</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">60.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">center</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1.5707963267948966</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">config</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#src.models.config.PhysicsConfig" title="src.models.config.PhysicsConfig"><span class="pre">PhysicsConfig</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/models/potentials.html#HarmonicPotential"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.models.potentials.HarmonicPotential" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#src.models.potentials.BasePotential" title="src.models.potentials.BasePotential"><code class="xref py py-class docutils literal notranslate"><span class="pre">BasePotential</span></code></a></p>
<p>Truncated harmonic oscillator (parabolic) potential.</p>
<p>Faithfully reproduces <code class="docutils literal notranslate"><span class="pre">potential_harmonic_finite(x,</span> <span class="pre">V0,</span> <span class="pre">omega,</span> <span class="pre">center)</span></code>
from <code class="docutils literal notranslate"><span class="pre">legacy/research_prototype.ipynb</span></code>.</p>
<p>The potential is defined as:</p>
<div class="math notranslate nohighlight">
\[V(x) = \min\!\left(\frac{1}{2} m\,\omega^2 (x - x_c)^2,\; V_{\rm lim}\right)\]</div>
<p>where <span class="math notranslate nohighlight">\(m\)</span> = <code class="docutils literal notranslate"><span class="pre">config.mass</span></code>, <span class="math notranslate nohighlight">\(\omega\)</span> is the angular
frequency, <span class="math notranslate nohighlight">\(x_c\)</span> is the well centre, and <span class="math notranslate nohighlight">\(V_{\rm lim}\)</span> is
the truncation ceiling.  Truncation ensures finite barrier heights for
numerical tractability without unphysical divergence.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>omega</strong> – Angular frequency <span class="math notranslate nohighlight">\(\omega\)</span> in dimensionless units.
Legacy default is <code class="docutils literal notranslate"><span class="pre">2.2</span></code>.</p></li>
<li><p><strong>v0_limit</strong> – Truncation ceiling <span class="math notranslate nohighlight">\(V_{\rm lim}\)</span> in dimensionless
energy units.  Legacy default is <code class="docutils literal notranslate"><span class="pre">60.0</span></code>.</p></li>
<li><p><strong>center</strong> – Position of the parabolic minimum <span class="math notranslate nohighlight">\(x_c\)</span> in
dimensionless length units.  Legacy default is <span class="math notranslate nohighlight">\(\pi/2\)</span>.</p></li>
<li><p><strong>config</strong> – Physics constants.  Reads <code class="docutils literal notranslate"><span class="pre">mass</span></code> for the prefactor
<span class="math notranslate nohighlight">\(\frac{1}{2} m \omega^2\)</span>.</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – If <code class="docutils literal notranslate"><span class="pre">omega</span> <span class="pre">&lt;=</span> <span class="pre">0</span></code> or <code class="docutils literal notranslate"><span class="pre">v0_limit</span> <span class="pre">&lt;=</span> <span class="pre">0</span></code>.</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span><span class="o">,</span><span class="w"> </span><span class="nn">math</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pot</span> <span class="o">=</span> <span class="n">HarmonicPotential</span><span class="p">(</span><span class="n">omega</span><span class="o">=</span><span class="mf">2.2</span><span class="p">,</span> <span class="n">v0_limit</span><span class="o">=</span><span class="mf">60.0</span><span class="p">,</span> <span class="n">center</span><span class="o">=</span><span class="n">math</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pot</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">math</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">2</span><span class="p">]))</span>   <span class="c1"># minimum at centre</span>
<span class="go">array([0.])</span>
</pre></div>
</div>
<dl class="py property">
<dt class="sig sig-object py" id="src.models.potentials.HarmonicPotential.center">
<span class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">center</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></span><a class="headerlink" href="#src.models.potentials.HarmonicPotential.center" title="Link to this definition"></a></dt>
<dd><p>Position of the parabolic minimum in dimensionless length units.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="src.models.potentials.HarmonicPotential.evaluate">
<span class="sig-name descname"><span class="pre">evaluate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">float64</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">float64</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/src/models/potentials.html#HarmonicPotential.evaluate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.models.potentials.HarmonicPotential.evaluate" title="Link to this definition"></a></dt>
<dd><p>Returns <span class="math notranslate nohighlight">\(V(x) = \min(\tfrac{1}{2}m\omega^2(x-x_c)^2,\, V_{\rm lim})\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x</strong> – 1D array of spatial coordinates in dimensionless length units.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Float64 array of the same shape as <code class="docutils literal notranslate"><span class="pre">x</span></code>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="src.models.potentials.HarmonicPotential.get_domain">
<span class="sig-name descname"><span class="pre">get_domain</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/src/models/potentials.html#HarmonicPotential.get_domain"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.models.potentials.HarmonicPotential.get_domain" title="Link to this definition"></a></dt>
<dd><p>Returns a domain that fully contains both well and barrier regions.</p>
<p>The truncation radius <span class="math notranslate nohighlight">\(r_t = \sqrt{2 V_{\rm lim} / (m\omega^2)}\)</span>
is the distance from the centre at which the parabola reaches
<span class="math notranslate nohighlight">\(V_{\rm lim}\)</span>.  A 50 % safety margin is added to ensure
the evanescent tail decays to zero within the grid.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The tuple <code class="docutils literal notranslate"><span class="pre">(center</span> <span class="pre">-</span> <span class="pre">1.5*r_t,</span> <span class="pre">center</span> <span class="pre">+</span> <span class="pre">1.5*r_t)</span></code>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="src.models.potentials.HarmonicPotential.omega">
<span class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">omega</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></span><a class="headerlink" href="#src.models.potentials.HarmonicPotential.omega" title="Link to this definition"></a></dt>
<dd><p>Angular frequency in dimensionless units.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="src.models.potentials.HarmonicPotential.v0_limit">
<span class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">v0_limit</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></span><a class="headerlink" href="#src.models.potentials.HarmonicPotential.v0_limit" title="Link to this definition"></a></dt>
<dd><p>Truncation ceiling in dimensionless energy units.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="src.models.potentials.InfiniteSquareWell">
<span class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></span><span class="sig-prename descclassname"><span class="pre">src.models.potentials.</span></span><span class="sig-name descname"><span class="pre">InfiniteSquareWell</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#src.models.config.PhysicsConfig" title="src.models.config.PhysicsConfig"><span class="pre">PhysicsConfig</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/models/potentials.html#InfiniteSquareWell"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.models.potentials.InfiniteSquareWell" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#src.models.potentials.BasePotential" title="src.models.potentials.BasePotential"><code class="xref py py-class docutils literal notranslate"><span class="pre">BasePotential</span></code></a></p>
<p>Infinite square-well potential with exact Dirichlet boundary conditions.</p>
<p>The potential is defined as:</p>
<div class="math notranslate nohighlight">
\[\begin{split}V(x) =
\begin{cases}
    0       &amp; \text{if } 0 \le x \le L \\
    +\infty &amp; \text{otherwise}
\end{cases}\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(L\)</span> = <code class="docutils literal notranslate"><span class="pre">config.well_width</span></code> (default <span class="math notranslate nohighlight">\(\pi\)</span>).</p>
<p>This geometry has an exact analytical eigenspectrum given by
<span class="math notranslate nohighlight">\(E_n = n^2\)</span> in the dimensionless unit system (<code class="docutils literal notranslate"><span class="pre">hbar=1</span></code>,
<code class="docutils literal notranslate"><span class="pre">mass=0.5</span></code>, <span class="math notranslate nohighlight">\(L=\pi\)</span>), which is used as the reference baseline
throughout the project.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>config</strong> – Physics constants.  Reads <code class="docutils literal notranslate"><span class="pre">well_width</span></code> to locate the right
wall of the box.</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">well</span> <span class="o">=</span> <span class="n">InfiniteSquareWell</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">+</span> <span class="mf">0.1</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">well</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="go">array([inf,  0.,  0.,  0., inf])</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="src.models.potentials.InfiniteSquareWell.evaluate">
<span class="sig-name descname"><span class="pre">evaluate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">float64</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">float64</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/src/models/potentials.html#InfiniteSquareWell.evaluate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.models.potentials.InfiniteSquareWell.evaluate" title="Link to this definition"></a></dt>
<dd><p>Returns <span class="math notranslate nohighlight">\(V(x)\)</span> with <span class="math notranslate nohighlight">\(+\infty\)</span> walls at <span class="math notranslate nohighlight">\(x=0\)</span> and <span class="math notranslate nohighlight">\(x=L\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x</strong> – 1D array of spatial coordinates in dimensionless length units.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Float64 array of the same shape as <code class="docutils literal notranslate"><span class="pre">x</span></code>.  Values outside
<span class="math notranslate nohighlight">\([0, L]\)</span> are set to <code class="docutils literal notranslate"><span class="pre">np.inf</span></code>; values inside are <code class="docutils literal notranslate"><span class="pre">0.0</span></code>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="src.models.potentials.InfiniteSquareWell.get_domain">
<span class="sig-name descname"><span class="pre">get_domain</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/src/models/potentials.html#InfiniteSquareWell.get_domain"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.models.potentials.InfiniteSquareWell.get_domain" title="Link to this definition"></a></dt>
<dd><p>Returns <span class="math notranslate nohighlight">\([0, L]\)</span> — the exact physical domain of the box.</p>
<p>The solver requires Dirichlet conditions at both ends, so no external
margin is needed.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The tuple <code class="docutils literal notranslate"><span class="pre">(0.0,</span> <span class="pre">well_width)</span></code>.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="src.models.potentials.VShapedPotential">
<span class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></span><span class="sig-prename descclassname"><span class="pre">src.models.potentials.</span></span><span class="sig-name descname"><span class="pre">VShapedPotential</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">slope</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">28.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">v0_limit</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">60.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">center</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1.5707963267948966</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">config</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#src.models.config.PhysicsConfig" title="src.models.config.PhysicsConfig"><span class="pre">PhysicsConfig</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/models/potentials.html#VShapedPotential"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.models.potentials.VShapedPotential" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#src.models.potentials.BasePotential" title="src.models.potentials.BasePotential"><code class="xref py py-class docutils literal notranslate"><span class="pre">BasePotential</span></code></a></p>
<p>Truncated V-shape (linear) potential.</p>
<p>Faithfully reproduces <code class="docutils literal notranslate"><span class="pre">potential_vshape_finite(x,</span> <span class="pre">V0,</span> <span class="pre">slope,</span> <span class="pre">center)</span></code>
from <code class="docutils literal notranslate"><span class="pre">legacy/research_prototype.ipynb</span></code>.</p>
<p>The potential is defined as:</p>
<div class="math notranslate nohighlight">
\[V(x) = \min\!\left(s\,|x - x_c|,\; V_{\rm lim}\right)\]</div>
<p>where <span class="math notranslate nohighlight">\(s\)</span> is the linear slope, <span class="math notranslate nohighlight">\(x_c\)</span> is the cusp centre,
and <span class="math notranslate nohighlight">\(V_{\rm lim}\)</span> is the truncation ceiling.  The result is a
tent-shaped well with flat barriers once the slope reaches
<span class="math notranslate nohighlight">\(V_{\rm lim}\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>slope</strong> – Linear slope <span class="math notranslate nohighlight">\(s\)</span> in dimensionless energy-per-length
units.  Legacy default is <code class="docutils literal notranslate"><span class="pre">28.0</span></code>.</p></li>
<li><p><strong>v0_limit</strong> – Truncation ceiling <span class="math notranslate nohighlight">\(V_{\rm lim}\)</span> in dimensionless
energy units.  Legacy default is <code class="docutils literal notranslate"><span class="pre">60.0</span></code>.</p></li>
<li><p><strong>center</strong> – Position of the V-cusp <span class="math notranslate nohighlight">\(x_c\)</span> in dimensionless length
units.  Legacy default is <span class="math notranslate nohighlight">\(\pi/2\)</span>.</p></li>
<li><p><strong>config</strong> – Physics constants dataclass.  Not required to evaluate this
potential (no mass dependency), but accepted for interface
consistency.</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – If <code class="docutils literal notranslate"><span class="pre">slope</span> <span class="pre">&lt;=</span> <span class="pre">0</span></code> or <code class="docutils literal notranslate"><span class="pre">v0_limit</span> <span class="pre">&lt;=</span> <span class="pre">0</span></code>.</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span><span class="o">,</span><span class="w"> </span><span class="nn">math</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pot</span> <span class="o">=</span> <span class="n">VShapedPotential</span><span class="p">(</span><span class="n">slope</span><span class="o">=</span><span class="mf">28.0</span><span class="p">,</span> <span class="n">v0_limit</span><span class="o">=</span><span class="mf">60.0</span><span class="p">,</span> <span class="n">center</span><span class="o">=</span><span class="n">math</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pot</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">math</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">2</span><span class="p">]))</span>   <span class="c1"># cusp — minimum is zero</span>
<span class="go">array([0.])</span>
</pre></div>
</div>
<dl class="py property">
<dt class="sig sig-object py" id="src.models.potentials.VShapedPotential.center">
<span class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">center</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></span><a class="headerlink" href="#src.models.potentials.VShapedPotential.center" title="Link to this definition"></a></dt>
<dd><p>Cusp position in dimensionless length units.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="src.models.potentials.VShapedPotential.evaluate">
<span class="sig-name descname"><span class="pre">evaluate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">float64</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">float64</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/src/models/potentials.html#VShapedPotential.evaluate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.models.potentials.VShapedPotential.evaluate" title="Link to this definition"></a></dt>
<dd><p>Returns <span class="math notranslate nohighlight">\(V(x) = \min(s\,|x - x_c|,\, V_{\rm lim})\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x</strong> – 1D array of spatial coordinates in dimensionless length units.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Float64 array of the same shape as <code class="docutils literal notranslate"><span class="pre">x</span></code>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="src.models.potentials.VShapedPotential.get_domain">
<span class="sig-name descname"><span class="pre">get_domain</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/src/models/potentials.html#VShapedPotential.get_domain"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.models.potentials.VShapedPotential.get_domain" title="Link to this definition"></a></dt>
<dd><p>Returns a domain that fully contains the well and flat barriers.</p>
<p>The truncation radius <span class="math notranslate nohighlight">\(r_t = V_{\rm lim} / s\)</span> is the distance
from the cusp at which the slope reaches <span class="math notranslate nohighlight">\(V_{\rm lim}\)</span>.  A
50 % safety margin is added for the evanescent tails.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The tuple <code class="docutils literal notranslate"><span class="pre">(center</span> <span class="pre">-</span> <span class="pre">1.5*r_t,</span> <span class="pre">center</span> <span class="pre">+</span> <span class="pre">1.5*r_t)</span></code>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="src.models.potentials.VShapedPotential.slope">
<span class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">slope</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></span><a class="headerlink" href="#src.models.potentials.VShapedPotential.slope" title="Link to this definition"></a></dt>
<dd><p>Linear slope in dimensionless energy-per-length units.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="src.models.potentials.VShapedPotential.v0_limit">
<span class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">v0_limit</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></span><a class="headerlink" href="#src.models.potentials.VShapedPotential.v0_limit" title="Link to this definition"></a></dt>
<dd><p>Truncation ceiling in dimensionless energy units.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-src.models.states">
<span id="domain-models"></span><h2>Domain Models<a class="headerlink" href="#module-src.models.states" title="Link to this heading"></a></h2>
<p>Domain model for the output of a quantum eigenvalue solver.</p>
<p>The <a class="reference internal" href="#src.models.states.QuantumSystem" title="src.models.states.QuantumSystem"><code class="xref py py-class docutils literal notranslate"><span class="pre">QuantumSystem</span></code></a> class replaces the raw <code class="docutils literal notranslate"><span class="pre">tuple[NDArray,</span> <span class="pre">NDArray]</span></code>
previously returned by <a class="reference internal" href="#src.core.solvers.BaseSolver" title="src.core.solvers.BaseSolver"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseSolver</span></code></a>. It solves the
<strong>Data Desynchronisation</strong> problem: in the legacy prototype, the spatial grid
<code class="docutils literal notranslate"><span class="pre">x</span></code>, the energy array, and the wavefunction matrix were three separate
variables that could silently diverge (e.g. if <code class="docutils literal notranslate"><span class="pre">x</span></code> was rebuilt with different
parameters while the wavefunctions were kept from an earlier run).</p>
<p><code class="docutils literal notranslate"><span class="pre">QuantumSystem</span></code> bundles all four pieces of a solved quantum problem into a
single, self-validating, immutable object:</p>
<ul class="simple">
<li><p><strong>``x_grid``</strong> — the spatial coordinates on which wavefunctions are defined.</p></li>
<li><p><strong>``energies``</strong> — the eigenvalues <span class="math notranslate nohighlight">\(E_n\)</span> for each state.</p></li>
<li><p><strong>``wavefunctions``</strong> — the normalised <span class="math notranslate nohighlight">\(\psi_n(x)\)</span> columns.</p></li>
<li><p><strong>``potential``</strong> — the <a class="reference internal" href="#src.models.potentials.BasePotential" title="src.models.potentials.BasePotential"><code class="xref py py-class docutils literal notranslate"><span class="pre">BasePotential</span></code></a> that
was solved, providing geometry and physical-constant context.</p></li>
</ul>
<p>Shape consistency is enforced at construction time, making silent
desynchronisation impossible.</p>
<dl class="py class">
<dt class="sig sig-object py" id="src.models.states.QuantumSystem">
<span class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></span><span class="sig-prename descclassname"><span class="pre">src.models.states.</span></span><span class="sig-name descname"><span class="pre">QuantumSystem</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">energies</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">float64</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wavefunctions</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">float64</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x_grid</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">float64</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">potential</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#src.models.potentials.BasePotential" title="src.models.potentials.BasePotential"><span class="pre">BasePotential</span></a></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/models/states.html#QuantumSystem"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.models.states.QuantumSystem" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Immutable domain model encapsulating a solved 1D quantum system.</p>
<p>Bundles the spatial grid, eigenvalues, normalised eigenvectors, and the
originating potential into a single validated object.  All data is
accessible through read-only properties; no public attribute permits
post-construction mutation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>energies</strong> – 1D float64 array of shape <code class="docutils literal notranslate"><span class="pre">(n_states,)</span></code> containing the
eigenvalues <span class="math notranslate nohighlight">\(E_n\)</span> in dimensionless units of <span class="math notranslate nohighlight">\(E_1\)</span>,
sorted in ascending order.</p></li>
<li><p><strong>wavefunctions</strong> – 2D float64 array of shape <code class="docutils literal notranslate"><span class="pre">(n_points,</span> <span class="pre">n_states)</span></code>
where column <code class="docutils literal notranslate"><span class="pre">k</span></code> is <span class="math notranslate nohighlight">\(\psi_k(x)\)</span>, normalised so that
<span class="math notranslate nohighlight">\(\int |\psi_k|^2\, dx = 1\)</span>.</p></li>
<li><p><strong>x_grid</strong> – 1D float64 array of shape <code class="docutils literal notranslate"><span class="pre">(n_points,)</span></code> containing the
spatial coordinates in dimensionless length units on which every
column of <code class="docutils literal notranslate"><span class="pre">wavefunctions</span></code> is defined.</p></li>
<li><p><strong>potential</strong> – The concrete <a class="reference internal" href="#src.models.potentials.BasePotential" title="src.models.potentials.BasePotential"><code class="xref py py-class docutils literal notranslate"><span class="pre">BasePotential</span></code></a>
instance that was solved.  Retained for provenance — it carries
both the geometry and the <a class="reference internal" href="#src.models.config.PhysicsConfig" title="src.models.config.PhysicsConfig"><code class="xref py py-class docutils literal notranslate"><span class="pre">PhysicsConfig</span></code></a>
used during the solve.</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>ValueError</strong> – If <code class="docutils literal notranslate"><span class="pre">len(energies)</span> <span class="pre">!=</span> <span class="pre">wavefunctions.shape[1]</span></code>,
    meaning the number of eigenvalues does not match the number of
    wavefunction columns (state-count desynchronisation).</p></li>
<li><p><strong>ValueError</strong> – If <code class="docutils literal notranslate"><span class="pre">len(x_grid)</span> <span class="pre">!=</span> <span class="pre">wavefunctions.shape[0]</span></code>,
    meaning the spatial grid length does not match the wavefunction
    row count (grid-wavefunction desynchronisation).</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">src.core</span><span class="w"> </span><span class="kn">import</span> <span class="n">NumerovSolver</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">src.models</span><span class="w"> </span><span class="kn">import</span> <span class="n">InfiniteSquareWell</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">system</span> <span class="o">=</span> <span class="n">NumerovSolver</span><span class="p">()</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">InfiniteSquareWell</span><span class="p">(),</span> <span class="n">n_states</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">system</span><span class="o">.</span><span class="n">n_states</span>
<span class="go">5</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">system</span><span class="o">.</span><span class="n">ground_state_energy</span>   <span class="c1"># should be ≈ 1.0 in E₁ units</span>
<span class="go">1.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">prob</span> <span class="o">=</span> <span class="n">system</span><span class="o">.</span><span class="n">get_probability_density</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>  <span class="c1"># |ψ₁(x)|²</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">prob</span><span class="o">.</span><span class="n">shape</span> <span class="o">==</span> <span class="n">system</span><span class="o">.</span><span class="n">x_grid</span><span class="o">.</span><span class="n">shape</span>
<span class="go">True</span>
</pre></div>
</div>
<dl class="py property">
<dt class="sig sig-object py" id="src.models.states.QuantumSystem.energies">
<span class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">energies</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">float64</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><a class="headerlink" href="#src.models.states.QuantumSystem.energies" title="Link to this definition"></a></dt>
<dd><p>Eigenvalues <span class="math notranslate nohighlight">\(E_n\)</span>, shape <code class="docutils literal notranslate"><span class="pre">(n_states,)</span></code>.</p>
<p>Returned as a read-only view; modifying the returned array does not
affect the internal state of this object.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>NDArray[np.float64]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="src.models.states.QuantumSystem.get_probability_density">
<span class="sig-name descname"><span class="pre">get_probability_density</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state_index</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">float64</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/src/models/states.html#QuantumSystem.get_probability_density"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.models.states.QuantumSystem.get_probability_density" title="Link to this definition"></a></dt>
<dd><p>Returns the probability density <span class="math notranslate nohighlight">\(|\psi_n(x)|^2\)</span> for one eigenstate.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>state_index</strong> – Zero-based index of the eigenstate.  <code class="docutils literal notranslate"><span class="pre">0</span></code> is the
ground state, <code class="docutils literal notranslate"><span class="pre">1</span></code> is the first excited state, and so on.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>1D float64 array of shape <code class="docutils literal notranslate"><span class="pre">(n_points,)</span></code> containing
<span class="math notranslate nohighlight">\(|\psi_n(x)|^2\)</span> evaluated on <code class="docutils literal notranslate"><span class="pre">self.x_grid</span></code>.</p>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>IndexError</strong> – If <code class="docutils literal notranslate"><span class="pre">state_index</span></code> is outside <code class="docutils literal notranslate"><span class="pre">[0,</span> <span class="pre">n_states)</span></code>.</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">rho</span> <span class="o">=</span> <span class="n">system</span><span class="o">.</span><span class="n">get_probability_density</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>  <span class="c1"># ground state density</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">scipy.integrate</span><span class="w"> </span><span class="kn">import</span> <span class="n">trapezoid</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">trapezoid</span><span class="p">(</span><span class="n">rho</span><span class="p">,</span> <span class="n">system</span><span class="o">.</span><span class="n">x_grid</span><span class="p">)</span>  <span class="c1"># ≈ 1.0 by normalisation</span>
<span class="go">1.0</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="src.models.states.QuantumSystem.get_state">
<span class="sig-name descname"><span class="pre">get_state</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state_index</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">float64</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/src/models/states.html#QuantumSystem.get_state"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.models.states.QuantumSystem.get_state" title="Link to this definition"></a></dt>
<dd><p>Returns the wavefunction <span class="math notranslate nohighlight">\(\psi_n(x)\)</span> for one eigenstate.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>state_index</strong> – Zero-based index of the eigenstate.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>1D float64 array of shape <code class="docutils literal notranslate"><span class="pre">(n_points,)</span></code> containing
<span class="math notranslate nohighlight">\(\psi_n(x)\)</span> on <code class="docutils literal notranslate"><span class="pre">self.x_grid</span></code>.</p>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>IndexError</strong> – If <code class="docutils literal notranslate"><span class="pre">state_index</span></code> is outside <code class="docutils literal notranslate"><span class="pre">[0,</span> <span class="pre">n_states)</span></code>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="src.models.states.QuantumSystem.ground_state_energy">
<span class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">ground_state_energy</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></span><a class="headerlink" href="#src.models.states.QuantumSystem.ground_state_energy" title="Link to this definition"></a></dt>
<dd><p>Energy of the lowest eigenstate <span class="math notranslate nohighlight">\(E_1\)</span> in units of <span class="math notranslate nohighlight">\(E_1\)</span>.</p>
<p>Equivalent to <code class="docutils literal notranslate"><span class="pre">self.energies[0]</span></code>, provided as a named property for
readability in downstream code (e.g. thermal partition functions).</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="src.models.states.QuantumSystem.n_states">
<span class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">n_states</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></span><a class="headerlink" href="#src.models.states.QuantumSystem.n_states" title="Link to this definition"></a></dt>
<dd><p>Number of eigenstates contained in this system.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="src.models.states.QuantumSystem.potential">
<span class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">potential</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#src.models.potentials.BasePotential" title="src.models.potentials.BasePotential"><span class="pre">BasePotential</span></a></span><a class="headerlink" href="#src.models.states.QuantumSystem.potential" title="Link to this definition"></a></dt>
<dd><p>The originating potential instance, read-only.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#src.models.potentials.BasePotential" title="src.models.potentials.BasePotential">BasePotential</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="src.models.states.QuantumSystem.wavefunctions">
<span class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">wavefunctions</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">float64</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><a class="headerlink" href="#src.models.states.QuantumSystem.wavefunctions" title="Link to this definition"></a></dt>
<dd><p>Normalised <span class="math notranslate nohighlight">\(\psi_n(x)\)</span>, shape <code class="docutils literal notranslate"><span class="pre">(n_points,</span> <span class="pre">n_states)</span></code>.</p>
<p>Column <code class="docutils literal notranslate"><span class="pre">k</span></code> corresponds to the <code class="docutils literal notranslate"><span class="pre">k</span></code>-th eigenstate.  Returned as a
read-only view.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>NDArray[np.float64]</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="src.models.states.QuantumSystem.x_grid">
<span class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">x_grid</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">float64</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><a class="headerlink" href="#src.models.states.QuantumSystem.x_grid" title="Link to this definition"></a></dt>
<dd><p>Spatial coordinates in dimensionless length units, shape <code class="docutils literal notranslate"><span class="pre">(n_points,)</span></code>.</p>
<p>The spatial axis shared by all wavefunction columns.  Returned as a
read-only view.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>NDArray[np.float64]</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-src.core.solvers">
<span id="core-engine-solvers"></span><h2>Core Engine (Solvers)<a class="headerlink" href="#module-src.core.solvers" title="Link to this heading"></a></h2>
<p>Matrix Numerov eigenvalue solver for the 1D Time-Independent Schrödinger Equation.</p>
<p>This module provides the <a class="reference internal" href="#src.core.solvers.NumerovSolver" title="src.core.solvers.NumerovSolver"><code class="xref py py-class docutils literal notranslate"><span class="pre">NumerovSolver</span></code></a> service class, which refactors
the procedural <code class="docutils literal notranslate"><span class="pre">solve_schrodinger_numerov</span></code> function from
<code class="docutils literal notranslate"><span class="pre">legacy/research_prototype.ipynb</span></code> into a production-grade engine.</p>
<section id="mathematical-background">
<h3>Mathematical Background<a class="headerlink" href="#mathematical-background" title="Link to this heading"></a></h3>
<p>The TISE in dimensionless units is:</p>
<div class="math notranslate nohighlight">
\[-\frac{\hbar^2}{2m} \frac{d^2\psi}{dx^2} + V(x)\psi = E\psi\]</div>
<p>which, after substituting the scaled variable <span class="math notranslate nohighlight">\(\varepsilon = 2mE/\hbar^2\)</span>
and <span class="math notranslate nohighlight">\(U(x) = (2m/\hbar^2)V(x)\)</span>, becomes:</p>
<div class="math notranslate nohighlight">
\[\psi'' + (\varepsilon - U(x))\psi = 0\]</div>
<p><strong>Why O(dx⁴)?  The Numerov Advantage</strong></p>
<p>A standard central-difference second derivative has <span class="math notranslate nohighlight">\(O(dx^2)\)</span> local
truncation error:</p>
<div class="math notranslate nohighlight">
\[\psi''_i = \frac{\psi_{i+1} - 2\psi_i + \psi_{i-1}}{dx^2} + O(dx^2)\]</div>
<p>The Numerov method improves this by exploiting the structure of the
differential equation itself.  Starting from the exact Taylor expansion:</p>
<div class="math notranslate nohighlight">
\[\psi_{i+1} + \psi_{i-1} = 2\psi_i + dx^2 \psi''_i + \frac{dx^4}{12}
\psi''''_i + O(dx^6)\]</div>
<p>and noting that for the TISE <span class="math notranslate nohighlight">\(\psi'''' = (U-\varepsilon)^2\psi + O(dx^2)\)</span>,
the fourth-derivative term can be approximated to <span class="math notranslate nohighlight">\(O(dx^2)\)</span> by a second
finite difference of <span class="math notranslate nohighlight">\((U-\varepsilon)\psi\)</span>:</p>
<div class="math notranslate nohighlight">
\[\frac{dx^4}{12}\psi''''_i \approx \frac{dx^2}{12}
\left[f_{i+1}\psi_{i+1} - 2f_i\psi_i + f_{i-1}\psi_{i-1}\right]
+ O(dx^6)\]</div>
<p>where <span class="math notranslate nohighlight">\(f_i = U_i - \varepsilon\)</span>.  Substituting into the Taylor expansion
and rearranging gives the Numerov recurrence, which has a <strong>global truncation
error of</strong> <span class="math notranslate nohighlight">\(O(dx^4)\)</span> — two orders better than standard FD.</p>
<p><strong>Matrix Form (Generalized Eigenvalue Problem)</strong></p>
<p>Applying the Numerov recurrence to all <span class="math notranslate nohighlight">\(N-2\)</span> interior grid points
(with Dirichlet boundary conditions <span class="math notranslate nohighlight">\(\psi_0 = \psi_{N-1} = 0\)</span>) leads to:</p>
<div class="math notranslate nohighlight">
\[A\,\psi = \varepsilon\, B\,\psi\]</div>
<p>where:</p>
<div class="math notranslate nohighlight">
\[A = \underbrace{\frac{-1}{dx^2} M_{-2}}_{\text{kinetic}} +
    \underbrace{\frac{1}{12} M_{10}\, \mathrm{diag}(U)}_{\text{potential}}
\qquad
B = \frac{1}{12} M_{10}\]</div>
<p><span class="math notranslate nohighlight">\(M_{-2}\)</span> is the tridiagonal matrix with <span class="math notranslate nohighlight">\(-2\)</span> on the main diagonal
and <span class="math notranslate nohighlight">\(+1\)</span> on the first off-diagonals (the standard second-difference
stencil).  <span class="math notranslate nohighlight">\(M_{10}\)</span> is the tridiagonal matrix with <span class="math notranslate nohighlight">\(10\)</span> on the
main diagonal and <span class="math notranslate nohighlight">\(+1\)</span> on the first off-diagonals (the Numerov weight
matrix).  Both are <em>symmetric</em>.</p>
<p>After solving for <span class="math notranslate nohighlight">\(\varepsilon\)</span>, the physical energies are recovered as:</p>
<div class="math notranslate nohighlight">
\[E_n = \varepsilon_n \cdot \frac{\hbar^2}{2m} = \frac{\varepsilon_n}{f}
\qquad f = \frac{2m}{\hbar^2}\]</div>
</section>
<dl class="py class">
<dt class="sig sig-object py" id="src.core.solvers.BaseSolver">
<span class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></span><span class="sig-prename descclassname"><span class="pre">src.core.solvers.</span></span><span class="sig-name descname"><span class="pre">BaseSolver</span></span><a class="reference internal" href="_modules/src/core/solvers.html#BaseSolver"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.core.solvers.BaseSolver" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">ABC</span></code></p>
<p>Abstract base class defining the interface for all 1D TISE solvers.</p>
<p>Any numerical method that solves the Time-Independent Schrödinger Equation
— be it Matrix Numerov, Finite Element, or a Shooting Method — must
implement this contract.  High-level “Experiment” code depends <em>only</em> on
this interface, never on a concrete solver implementation.</p>
<p>This enforces the <strong>Dependency Inversion Principle</strong>: abstractions own the
policy; concrete solvers own the algorithm.  Swapping from Numerov to FEM
requires only a new subclass, with zero changes to any consumer.</p>
<p class="rubric">Example</p>
<p>Define and use a custom solver transparently:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">class</span><span class="w"> </span><span class="nc">ShootingSolver</span><span class="p">(</span><span class="n">BaseSolver</span><span class="p">):</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">solve</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">potential</span><span class="p">:</span> <span class="n">BasePotential</span><span class="p">,</span>
        <span class="n">n_states</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">20</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">QuantumSystem</span><span class="p">:</span>
        <span class="o">...</span>  <span class="c1"># shooting-method implementation</span>

<span class="n">experiment</span><span class="p">:</span> <span class="n">BaseSolver</span> <span class="o">=</span> <span class="n">ShootingSolver</span><span class="p">()</span>
<span class="n">system</span> <span class="o">=</span> <span class="n">experiment</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">InfiniteSquareWell</span><span class="p">())</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="src.core.solvers.BaseSolver.solve">
<span class="property"><span class="k"><span class="pre">abstractmethod</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">solve</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">potential</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#src.models.potentials.BasePotential" title="src.models.potentials.BasePotential"><span class="pre">BasePotential</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_states</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">20</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#src.models.states.QuantumSystem" title="src.models.states.QuantumSystem"><span class="pre">QuantumSystem</span></a></span></span><a class="reference internal" href="_modules/src/core/solvers.html#BaseSolver.solve"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.core.solvers.BaseSolver.solve" title="Link to this definition"></a></dt>
<dd><p>Solves the 1D TISE and returns the lowest <code class="docutils literal notranslate"><span class="pre">n_states</span></code> eigenpairs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>potential</strong> – Any concrete <a class="reference internal" href="#src.models.potentials.BasePotential" title="src.models.potentials.BasePotential"><code class="xref py py-class docutils literal notranslate"><span class="pre">BasePotential</span></code></a>
subclass supplying <span class="math notranslate nohighlight">\(V(x)\)</span> and the spatial domain.</p></li>
<li><p><strong>n_states</strong> – Number of lowest-energy eigenvalues and eigenvectors to
compute.  Must be at least 1.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A <a class="reference internal" href="#src.models.states.QuantumSystem" title="src.models.states.QuantumSystem"><code class="xref py py-class docutils literal notranslate"><span class="pre">QuantumSystem</span></code></a> containing the
spatial grid, eigenvalues <span class="math notranslate nohighlight">\(E_n\)</span>, normalised eigenvectors
<span class="math notranslate nohighlight">\(\psi_n(x)\)</span>, and a reference to the originating potential.</p>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>ValueError</strong> – If <code class="docutils literal notranslate"><span class="pre">n_states</span> <span class="pre">&lt;</span> <span class="pre">1</span></code>.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="src.core.solvers.NumerovSolver">
<span class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></span><span class="sig-prename descclassname"><span class="pre">src.core.solvers.</span></span><span class="sig-name descname"><span class="pre">NumerovSolver</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#src.models.config.NumericalConfig" title="src.models.config.NumericalConfig"><span class="pre">NumericalConfig</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/core/solvers.html#NumerovSolver"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.core.solvers.NumerovSolver" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#src.core.solvers.BaseSolver" title="src.core.solvers.BaseSolver"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseSolver</span></code></a></p>
<p>Service class that solves the 1D TISE via the Matrix Numerov method.</p>
<p>Encapsulates the full Numerov eigenvalue pipeline:
(1) auto-build the spatial grid from the potential’s own domain,
(2) assemble the symmetric generalised-eigenvalue matrices A and B,
(3) solve with <code class="docutils literal notranslate"><span class="pre">scipy.linalg.eigh</span></code> (optimised for real-symmetric</p>
<blockquote>
<div><p>positive-definite pencils),</p>
</div></blockquote>
<ol class="arabic simple" start="4">
<li><p>recover physical energies and normalise wavefunctions.</p></li>
</ol>
<p>The solver is <strong>closed for modification</strong> and <strong>open for extension</strong> via
any subclass of <a class="reference internal" href="#src.models.potentials.BasePotential" title="src.models.potentials.BasePotential"><code class="xref py py-class docutils literal notranslate"><span class="pre">BasePotential</span></code></a> — the
potential geometry is injected through <a class="reference internal" href="#src.core.solvers.NumerovSolver.solve" title="src.core.solvers.NumerovSolver.solve"><code class="xref py py-meth docutils literal notranslate"><span class="pre">solve()</span></code></a>, never hardcoded.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>config</strong> – Numerical discretisation parameters.  When <code class="docutils literal notranslate"><span class="pre">None</span></code>,
defaults are used (600 grid points, convergence tolerance 1e-4).</p>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="src.core.solvers.NumerovSolver.config">
<span class="sig-name descname"><span class="pre">config</span></span><a class="headerlink" href="#src.core.solvers.NumerovSolver.config" title="Link to this definition"></a></dt>
<dd><p>The injected <a class="reference internal" href="#src.models.config.NumericalConfig" title="src.models.config.NumericalConfig"><code class="xref py py-class docutils literal notranslate"><span class="pre">NumericalConfig</span></code></a>,
read-only after construction.</p>
</dd></dl>

<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">src.models</span><span class="w"> </span><span class="kn">import</span> <span class="n">InfiniteSquareWell</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">solver</span> <span class="o">=</span> <span class="n">NumerovSolver</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">energies</span><span class="p">,</span> <span class="n">wavefunctions</span> <span class="o">=</span> <span class="n">solver</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">InfiniteSquareWell</span><span class="p">(),</span> <span class="n">n_states</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># energies ≈ [1, 4, 9, 16, 25] in dimensionless E₁ units</span>
</pre></div>
</div>
<dl class="py property">
<dt class="sig sig-object py" id="id9">
<span class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">config</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#src.models.config.NumericalConfig" title="src.models.config.NumericalConfig"><span class="pre">NumericalConfig</span></a></span><a class="headerlink" href="#id9" title="Link to this definition"></a></dt>
<dd><p>The injected numerical parameters, read-only.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#src.models.config.NumericalConfig" title="src.models.config.NumericalConfig">NumericalConfig</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="src.core.solvers.NumerovSolver.solve">
<span class="sig-name descname"><span class="pre">solve</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">potential</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#src.models.potentials.BasePotential" title="src.models.potentials.BasePotential"><span class="pre">BasePotential</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_states</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">20</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#src.models.states.QuantumSystem" title="src.models.states.QuantumSystem"><span class="pre">QuantumSystem</span></a></span></span><a class="reference internal" href="_modules/src/core/solvers.html#NumerovSolver.solve"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.core.solvers.NumerovSolver.solve" title="Link to this definition"></a></dt>
<dd><p>Solves the 1D TISE for the given potential and returns a QuantumSystem.</p>
<p>The method follows these steps:</p>
<ol class="arabic simple">
<li><p><strong>Auto-Grid</strong>: Calls <code class="docutils literal notranslate"><span class="pre">potential.get_domain()</span></code> to obtain
<span class="math notranslate nohighlight">\([x_{min}, x_{max}]\)</span> and builds a uniform grid of
<code class="docutils literal notranslate"><span class="pre">config.n_points</span></code> points.  The domain is set by the
<em>potential</em>, not by global constants.</p></li>
<li><p><strong>Matrix assembly</strong>: Constructs the symmetric generalised
matrices <span class="math notranslate nohighlight">\(A\)</span> and <span class="math notranslate nohighlight">\(B\)</span> from the Numerov recurrence
using only the <span class="math notranslate nohighlight">\(N-2\)</span> interior grid points (Dirichlet BCs).</p></li>
<li><p><strong>Solve</strong>: Calls <code class="docutils literal notranslate"><span class="pre">scipy.linalg.eigh(A,</span> <span class="pre">B,</span> <span class="pre">subset_by_index=...)</span></code>,
which is optimised for symmetric-positive-definite pencils and
returns eigenvalues in ascending order without post-sorting.</p></li>
<li><p><strong>Energy recovery</strong>: Converts dimensionless eigenvalues
<span class="math notranslate nohighlight">\(\varepsilon_n\)</span> to physical energies
<span class="math notranslate nohighlight">\(E_n = \varepsilon_n \hbar^2 / (2m)\)</span>.</p></li>
<li><p><strong>Normalisation</strong>: Calls <code class="xref py py-meth docutils literal notranslate"><span class="pre">_normalize()</span></code> on each wavefunction
so that <span class="math notranslate nohighlight">\(\int |\psi_n(x)|^2\, dx = 1\)</span>.</p></li>
<li><p><strong>Wrapping</strong>: Bundles the spatial grid, energies, wavefunctions,
and originating potential into a <a class="reference internal" href="#src.models.states.QuantumSystem" title="src.models.states.QuantumSystem"><code class="xref py py-class docutils literal notranslate"><span class="pre">QuantumSystem</span></code></a>
domain model, enforcing shape consistency and eliminating data
desynchronisation.</p></li>
</ol>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>potential</strong> – Any concrete <a class="reference internal" href="#src.models.potentials.BasePotential" title="src.models.potentials.BasePotential"><code class="xref py py-class docutils literal notranslate"><span class="pre">BasePotential</span></code></a>
subclass.  The solver reads <code class="docutils literal notranslate"><span class="pre">potential.config</span></code> for physical
constants and <code class="docutils literal notranslate"><span class="pre">potential.get_domain()</span></code> for the grid domain.</p></li>
<li><p><strong>n_states</strong> – Number of lowest eigenvalues/eigenvectors to compute.
Requesting fewer states is significantly faster for large grids
because <code class="docutils literal notranslate"><span class="pre">eigh</span></code> uses a divide-and-conquer LAPACK driver.
Defaults to 20.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">energies</span></code> — 1D float64 array of shape <code class="docutils literal notranslate"><span class="pre">(n_states,)</span></code>
containing <span class="math notranslate nohighlight">\(E_n\)</span> in dimensionless units of <span class="math notranslate nohighlight">\(E_1\)</span>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">wavefunctions</span></code> — 2D float64 array of shape
<code class="docutils literal notranslate"><span class="pre">(n_points,</span> <span class="pre">n_states)</span></code> where column <code class="docutils literal notranslate"><span class="pre">k</span></code> is
<span class="math notranslate nohighlight">\(\psi_k(x)\)</span>, normalised so that
<span class="math notranslate nohighlight">\(\int |\psi_k|^2\, dx = 1\)</span>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">x_grid</span></code> — the uniform spatial coordinate array.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">potential</span></code> — the originating <a class="reference internal" href="#src.models.potentials.BasePotential" title="src.models.potentials.BasePotential"><code class="xref py py-class docutils literal notranslate"><span class="pre">BasePotential</span></code></a>.</p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>A <a class="reference internal" href="#src.models.states.QuantumSystem" title="src.models.states.QuantumSystem"><code class="xref py py-class docutils literal notranslate"><span class="pre">QuantumSystem</span></code></a> containing</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – If <code class="docutils literal notranslate"><span class="pre">n_states</span> <span class="pre">&lt;</span> <span class="pre">1</span></code> or if the grid has fewer than 3
    points (making a 0-sized interior impossible).</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p><strong>Symmetrisation of</strong> <span class="math notranslate nohighlight">\(A\)</span>: The potential term
<span class="math notranslate nohighlight">\((1/12) M_{10} \cdot \mathrm{diag}(U)\)</span> is not exactly
symmetric for spatially varying <span class="math notranslate nohighlight">\(U(x)\)</span>, because its
<span class="math notranslate nohighlight">\((i, j)\)</span> off-diagonal entry is <span class="math notranslate nohighlight">\(M_{10}[i,j] \cdot U_j\)</span>
while its transpose has <span class="math notranslate nohighlight">\(M_{10}[i,j] \cdot U_i\)</span>.  The
asymmetry at neighbouring nodes is <span class="math notranslate nohighlight">\(O(dx)\)</span>.  We symmetrise
<span class="math notranslate nohighlight">\(A\)</span> explicitly via <span class="math notranslate nohighlight">\(A \leftarrow (A + A^T)/2\)</span> before
passing it to <code class="docutils literal notranslate"><span class="pre">eigh</span></code>.  By first-order perturbation theory the
anti-symmetric part has zero quadratic form on real eigenvectors
(it is anti-Hermitian), so the eigenvalue error from this step is
at most <span class="math notranslate nohighlight">\(O(dx^2)\)</span> — well within the <span class="math notranslate nohighlight">\(10^{-3}\)</span> tolerance
required for all physics analyses in this project.</p>
</dd></dl>

</dd></dl>

</section>
<section id="module-src.models.statistics">
<span id="particle-statistics"></span><h2>Particle Statistics<a class="headerlink" href="#module-src.models.statistics" title="Link to this heading"></a></h2>
<p>Particle-statistics enumeration for the two-particle thermal engine.</p>
<p>This module defines <a class="reference internal" href="#src.models.statistics.ParticleType" title="src.models.statistics.ParticleType"><code class="xref py py-class docutils literal notranslate"><span class="pre">ParticleType</span></code></a>, an enumeration whose members
select the quantum-mechanical symmetry requirement applied to the two-particle
spatial wavefunction inside <a class="reference internal" href="#src.core.statistics.ThermalEngine" title="src.core.statistics.ThermalEngine"><code class="xref py py-class docutils literal notranslate"><span class="pre">ThermalEngine</span></code></a>.</p>
<section id="background">
<h3>Background<a class="headerlink" href="#background" title="Link to this heading"></a></h3>
<p>The <strong>Symmetry Postulate</strong> of quantum mechanics (Pauli, 1940) states that the
total wavefunction of a system of <em>identical</em> particles must be either
<em>completely symmetric</em> (bosons) or <em>completely antisymmetric</em> (fermions) under
the exchange of any two particles.  Because the total wavefunction factorises
into a <em>spatial</em> part and a <em>spin</em> part, different spin-multiplet populations
impose different symmetry requirements on the spatial wavefunction.</p>
<p>The five members of <a class="reference internal" href="#src.models.statistics.ParticleType" title="src.models.statistics.ParticleType"><code class="xref py py-class docutils literal notranslate"><span class="pre">ParticleType</span></code></a> cover the four cases implemented in
<code class="docutils literal notranslate"><span class="pre">legacy/research_prototype.ipynb</span></code> plus a classical reference:</p>
<p><strong>SPIN_HALF derivation</strong> (spin-1/2 fermions, fully mixed spin state):
The two-particle spin Hilbert space has dimension 4.  The singlet state
(<span class="math notranslate nohighlight">\(S=0\)</span>, antisymmetric spin) pairs with a <em>symmetric</em> spatial state so
that the total wavefunction is antisymmetric; the triplet (<span class="math notranslate nohighlight">\(S=1\)</span>,
3 symmetric spin states) pairs with an <em>antisymmetric</em> spatial state.
At infinite temperature, all four spin states are equally likely, giving:</p>
<div class="math notranslate nohighlight">
\[P_{\text{SPIN-1/2}} = \frac{1}{4} P_S + \frac{3}{4} P_A\]</div>
<p><strong>SPIN_ONE derivation</strong> (spin-1 bosons, fully mixed spin state):
The spin Hilbert space has dimension 9.  States with total spin
<span class="math notranslate nohighlight">\(S=2\)</span> (5 states, symmetric spin) and <span class="math notranslate nohighlight">\(S=0\)</span> (1 state, symmetric
spin) require symmetric spatial parts; <span class="math notranslate nohighlight">\(S=1\)</span> (3 states, antisymmetric
spin) requires an antisymmetric spatial part.  Hence:</p>
<div class="math notranslate nohighlight">
\[P_{\text{SPIN-1}} = \frac{6}{9} P_S + \frac{3}{9} P_A
                   = \frac{2}{3} P_S + \frac{1}{3} P_A\]</div>
</section>
<dl class="py class">
<dt class="sig sig-object py" id="src.models.statistics.ParticleType">
<span class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></span><span class="sig-prename descclassname"><span class="pre">src.models.statistics.</span></span><span class="sig-name descname"><span class="pre">ParticleType</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">values</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/models/statistics.html#ParticleType"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.models.statistics.ParticleType" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Enum</span></code></p>
<p>Enumeration of two-particle statistics / symmetry types.</p>
<p>Each member controls how <a class="reference internal" href="#src.core.statistics.ThermalEngine" title="src.core.statistics.ThermalEngine"><code class="xref py py-class docutils literal notranslate"><span class="pre">ThermalEngine</span></code></a>
symmetrises the two-particle spatial wavefunction.</p>
<dl class="simple">
<dt>Members:</dt><dd><dl class="simple">
<dt>BOLTZMANN: Classical, distinguishable particles.  No exchange</dt><dd><p>symmetry is imposed.  The two-particle density is the direct
(outer) product of two independent single-particle densities.
This serves as the classical reference for comparing quantum
bunching / antibunching effects.</p>
</dd>
<dt>BOSON: Identical bosons (integer total spin).  The spatial</dt><dd><p>wavefunction is fully <em>symmetric</em> under exchange:
<span class="math notranslate nohighlight">\(\Psi_S \propto \phi_n(x_1)\phi_m(x_2)
+ \phi_n(x_2)\phi_m(x_1)\)</span>.
Bosons tend to <em>bunch</em> (enhanced probability near the diagonal
<span class="math notranslate nohighlight">\(x_1 = x_2\)</span>).</p>
</dd>
<dt>FERMION: Identical fermions in a spin-polarised state (or any</dt><dd><p>state with a definite antisymmetric spin part).  The spatial
wavefunction is fully <em>antisymmetric</em> under exchange:
<span class="math notranslate nohighlight">\(\Psi_A \propto \phi_n(x_1)\phi_m(x_2)
- \phi_n(x_2)\phi_m(x_1)\)</span>.
The Pauli Exclusion Principle is a direct consequence:
<span class="math notranslate nohighlight">\(\Psi_A(x, x) = 0\)</span> exactly, so the diagonal of the
two-particle density vanishes identically.</p>
</dd>
<dt>SPIN_HALF: Two spin-1/2 particles in a thermally mixed spin state</dt><dd><p>(equal population of all four spin substates).  Results in a
spatial mixture of <span class="math notranslate nohighlight">\(1/4\, P_S + 3/4\, P_A\)</span>.</p>
</dd>
<dt>SPIN_ONE: Two spin-1 particles in a thermally mixed spin state</dt><dd><p>(equal population of all nine spin substates).  Results in a
spatial mixture of <span class="math notranslate nohighlight">\(2/3\, P_S + 1/3\, P_A\)</span>.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">src.models.statistics</span><span class="w"> </span><span class="kn">import</span> <span class="n">ParticleType</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ParticleType</span><span class="o">.</span><span class="n">SPIN_HALF</span>
<span class="go">&lt;ParticleType.SPIN_HALF: 4&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ParticleType</span><span class="o">.</span><span class="n">SPIN_HALF</span><span class="o">.</span><span class="n">name</span>
<span class="go">&#39;SPIN_HALF&#39;</span>
</pre></div>
</div>
<dl class="py attribute">
<dt class="sig sig-object py" id="src.models.statistics.ParticleType.BOLTZMANN">
<span class="sig-name descname"><span class="pre">BOLTZMANN</span></span><span class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">1</span></span><a class="headerlink" href="#src.models.statistics.ParticleType.BOLTZMANN" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="src.models.statistics.ParticleType.BOSON">
<span class="sig-name descname"><span class="pre">BOSON</span></span><span class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">2</span></span><a class="headerlink" href="#src.models.statistics.ParticleType.BOSON" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="src.models.statistics.ParticleType.FERMION">
<span class="sig-name descname"><span class="pre">FERMION</span></span><span class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">3</span></span><a class="headerlink" href="#src.models.statistics.ParticleType.FERMION" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="src.models.statistics.ParticleType.SPIN_HALF">
<span class="sig-name descname"><span class="pre">SPIN_HALF</span></span><span class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">4</span></span><a class="headerlink" href="#src.models.statistics.ParticleType.SPIN_HALF" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="src.models.statistics.ParticleType.SPIN_ONE">
<span class="sig-name descname"><span class="pre">SPIN_ONE</span></span><span class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">5</span></span><a class="headerlink" href="#src.models.statistics.ParticleType.SPIN_ONE" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<p id="module-src.core.statistics">Thermal statistics engine for 1D quantum systems of identical particles.</p>
<p>This module provides <a class="reference internal" href="#src.core.statistics.ThermalEngine" title="src.core.statistics.ThermalEngine"><code class="xref py py-class docutils literal notranslate"><span class="pre">ThermalEngine</span></code></a>, the service class responsible for
all statistical-mechanics post-processing of a solved <code class="xref py py-class docutils literal notranslate"><span class="pre">QuantumSystem</span></code>.
It refactors and encapsulates two families of functions from
<code class="docutils literal notranslate"><span class="pre">legacy/research_prototype.ipynb</span></code>:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">calc_thermal_density</span></code> (single-particle Boltzmann-weighted density)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">get_pair_prob</span></code> + <code class="docutils literal notranslate"><span class="pre">calc_thermal_2p</span></code> (two-particle symmetrised density)</p></li>
</ul>
<section id="design-solid">
<h3>Design (SOLID)<a class="headerlink" href="#design-solid" title="Link to this heading"></a></h3>
<ul class="simple">
<li><p><strong>SRP</strong>: <code class="docutils literal notranslate"><span class="pre">ThermalEngine</span></code> does one thing — thermal averaging.  It never
touches eigenvalue solvers or potential geometry.</p></li>
<li><p><strong>OCP</strong>: New statistics (e.g. anyons) can be added by extending
<a class="reference internal" href="#src.models.statistics.ParticleType" title="src.models.statistics.ParticleType"><code class="xref py py-class docutils literal notranslate"><span class="pre">ParticleType</span></code></a> and the <code class="docutils literal notranslate"><span class="pre">_spin_components</span></code>
helper without modifying existing methods.</p></li>
<li><p><strong>DIP</strong>: All physics input arrives through the <a class="reference internal" href="#src.models.states.QuantumSystem" title="src.models.states.QuantumSystem"><code class="xref py py-class docutils literal notranslate"><span class="pre">QuantumSystem</span></code></a>
interface; no concrete solver class is imported.</p></li>
</ul>
</section>
<section id="mathematical-summary">
<h3>Mathematical Summary<a class="headerlink" href="#mathematical-summary" title="Link to this heading"></a></h3>
<p><strong>Single-particle thermal density</strong></p>
<div class="math notranslate nohighlight">
\[\rho_{\text{th}}(x) = \frac{1}{Z}
\sum_{n=0}^{N-1} e^{-(E_n - E_0)/(k_B T)}\, |\psi_n(x)|^2,
\qquad Z = \sum_{n=0}^{N-1} e^{-(E_n - E_0)/(k_B T)}\]</div>
<p>States are accumulated one at a time; summation stops when the maximum
pointwise change in <span class="math notranslate nohighlight">\(\rho(x)\)</span> falls below <code class="docutils literal notranslate"><span class="pre">tolerance</span></code>.</p>
<p><strong>Two-particle symmetrised pair density</strong> (for <span class="math notranslate nohighlight">\(n \neq m\)</span>)</p>
<div class="math notranslate nohighlight">
\[\Psi_S(x_1, x_2) = \frac{1}{\sqrt{2}}
\bigl[\phi_n(x_1)\phi_m(x_2) + \phi_n(x_2)\phi_m(x_1)\bigr]
\quad (\text{bosons})\]</div>
<div class="math notranslate nohighlight">
\[\Psi_A(x_1, x_2) = \frac{1}{\sqrt{2}}
\bigl[\phi_n(x_1)\phi_m(x_2) - \phi_n(x_2)\phi_m(x_1)\bigr]
\quad (\text{fermions})\]</div>
<p>The diagonal <span class="math notranslate nohighlight">\(\Psi_A(x, x) = 0\)</span> identically (Pauli Exclusion Principle).</p>
<p><strong>Thermal two-particle pair density</strong></p>
<div class="math notranslate nohighlight">
\[\rho_{\text{pair}}(x_1, x_2) = \frac{1}{Z}
\sum_{n,m} e^{-(E_n + E_m - 2E_0)/(k_B T)}\,
\sum_c f_c\, |\Psi_{c,nm}(x_1, x_2)|^2\]</div>
<p>where <span class="math notranslate nohighlight">\(c\)</span> indexes symmetry channels and <span class="math notranslate nohighlight">\(f_c\)</span> are the
spin-degeneracy fractions from <a class="reference internal" href="#src.models.statistics.ParticleType" title="src.models.statistics.ParticleType"><code class="xref py py-class docutils literal notranslate"><span class="pre">ParticleType</span></code></a>.</p>
</section>
<dl class="py class">
<dt class="sig sig-object py" id="src.core.statistics.ThermalEngine">
<span class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></span><span class="sig-prename descclassname"><span class="pre">src.core.statistics.</span></span><span class="sig-name descname"><span class="pre">ThermalEngine</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">log_level</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">30</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/core/statistics.html#ThermalEngine"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.core.statistics.ThermalEngine" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Service class for thermal and multi-particle statistical calculations.</p>
<p><a class="reference internal" href="#src.core.statistics.ThermalEngine" title="src.core.statistics.ThermalEngine"><code class="xref py py-class docutils literal notranslate"><span class="pre">ThermalEngine</span></code></a> is a stateless service: all state lives in the
<a class="reference internal" href="#src.models.states.QuantumSystem" title="src.models.states.QuantumSystem"><code class="xref py py-class docutils literal notranslate"><span class="pre">QuantumSystem</span></code></a> objects passed to its methods.
The engine is safe to instantiate once and reuse across multiple systems
and temperatures.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>log_level</strong> – Python logging level (e.g. <code class="docutils literal notranslate"><span class="pre">logging.DEBUG</span></code>) used for
internal convergence progress messages.  Defaults to
<code class="docutils literal notranslate"><span class="pre">logging.WARNING</span></code> (silent in normal use).</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">src.core</span><span class="w"> </span><span class="kn">import</span> <span class="n">NumerovSolver</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">src.core.statistics</span><span class="w"> </span><span class="kn">import</span> <span class="n">ThermalEngine</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">src.models</span><span class="w"> </span><span class="kn">import</span> <span class="n">InfiniteSquareWell</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">src.models.statistics</span><span class="w"> </span><span class="kn">import</span> <span class="n">ParticleType</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">system</span> <span class="o">=</span> <span class="n">NumerovSolver</span><span class="p">()</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">InfiniteSquareWell</span><span class="p">(),</span> <span class="n">n_states</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">engine</span> <span class="o">=</span> <span class="n">ThermalEngine</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rho</span>    <span class="o">=</span> <span class="n">engine</span><span class="o">.</span><span class="n">calculate_thermal_density</span><span class="p">(</span><span class="n">system</span><span class="p">,</span> <span class="n">temperature</span><span class="o">=</span><span class="mf">5.0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rho_2p</span> <span class="o">=</span> <span class="n">engine</span><span class="o">.</span><span class="n">calculate_pair_density</span><span class="p">(</span><span class="n">system</span><span class="p">,</span> <span class="mf">5.0</span><span class="p">,</span> <span class="n">ParticleType</span><span class="o">.</span><span class="n">FERMION</span><span class="p">)</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="src.core.statistics.ThermalEngine.calculate_pair_density">
<span class="sig-name descname"><span class="pre">calculate_pair_density</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">system</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#src.models.states.QuantumSystem" title="src.models.states.QuantumSystem"><span class="pre">QuantumSystem</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">temperature</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p_type</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#src.models.statistics.ParticleType" title="src.models.statistics.ParticleType"><span class="pre">ParticleType</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">float64</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/src/core/statistics.html#ThermalEngine.calculate_pair_density"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.core.statistics.ThermalEngine.calculate_pair_density" title="Link to this definition"></a></dt>
<dd><p>Computes the Boltzmann-weighted two-particle spatial density matrix.</p>
<p>Sums over all pairs <span class="math notranslate nohighlight">\((n, m)\)</span> of eigenstates, weighted by the
two-particle Boltzmann factor, and applies the symmetrisation required
by <code class="docutils literal notranslate"><span class="pre">p_type</span></code>:</p>
<div class="math notranslate nohighlight">
\[\rho_{\text{pair}}(x_1, x_2) = \frac{1}{Z}
\sum_{n=0}^{N-1} \sum_{m=0}^{N-1}
e^{-(E_n + E_m - 2 E_0)/(k_B T)}
\sum_c f_c\, |\Psi_{c,nm}(x_1, x_2)|^2\]</div>
<p>The energy reference <span class="math notranslate nohighlight">\(2 E_0\)</span> (twice the single-particle ground
state) is subtracted to prevent floating-point underflow.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>system</strong> – A solved <a class="reference internal" href="#src.models.states.QuantumSystem" title="src.models.states.QuantumSystem"><code class="xref py py-class docutils literal notranslate"><span class="pre">QuantumSystem</span></code></a>.</p></li>
<li><p><strong>temperature</strong> – Absolute temperature <span class="math notranslate nohighlight">\(T\)</span> in dimensionless units.</p></li>
<li><p><strong>p_type</strong> – The <a class="reference internal" href="#src.models.statistics.ParticleType" title="src.models.statistics.ParticleType"><code class="xref py py-class docutils literal notranslate"><span class="pre">ParticleType</span></code></a> controlling
symmetry (and spin-mixture fractions) of the pair wavefunction.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>2D float64 array of shape <code class="docutils literal notranslate"><span class="pre">(n_points,</span> <span class="pre">n_points)</span></code> where entry
<code class="docutils literal notranslate"><span class="pre">[i,</span> <span class="pre">j]</span></code> is the thermal pair probability density at
<span class="math notranslate nohighlight">\((x_i, x_j)\)</span>.</p>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>ValueError</strong> – If <code class="docutils literal notranslate"><span class="pre">temperature</span> <span class="pre">&lt;=</span> <span class="pre">0</span></code>.</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p><strong>Performance</strong>: The inner loop constructs one <code class="docutils literal notranslate"><span class="pre">(N,</span> <span class="pre">N)</span></code> outer
product per state pair using <code class="xref py py-func docutils literal notranslate"><span class="pre">numpy.outer()</span></code> (BLAS level-2).
For <code class="docutils literal notranslate"><span class="pre">n_states=20</span></code> and <code class="docutils literal notranslate"><span class="pre">N=600</span></code>, this is 400 outer products of
size <span class="math notranslate nohighlight">\(600 \times 600 = 360{,}000\)</span> elements each — fully
vectorised and cache-friendly.</p>
<p><strong>Fermionic normalisation</strong>: For <code class="xref py py-data docutils literal notranslate"><span class="pre">ParticleType.FERMION</span></code>, pairs
with <span class="math notranslate nohighlight">\(n_1 = n_2\)</span> contribute zero probability density (Pauli
Exclusion) but their Boltzmann weight still enters <span class="math notranslate nohighlight">\(Z\)</span>.  This
mirrors the legacy implementation and preserves relative comparison
between boson and fermion distributions.</p>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">rho_2p</span> <span class="o">=</span> <span class="n">engine</span><span class="o">.</span><span class="n">calculate_pair_density</span><span class="p">(</span><span class="n">system</span><span class="p">,</span> <span class="mf">10.0</span><span class="p">,</span> <span class="n">ParticleType</span><span class="o">.</span><span class="n">BOSON</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rho_2p</span><span class="o">.</span><span class="n">shape</span>
<span class="go">(600, 600)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="src.core.statistics.ThermalEngine.calculate_thermal_density">
<span class="sig-name descname"><span class="pre">calculate_thermal_density</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">system</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#src.models.states.QuantumSystem" title="src.models.states.QuantumSystem"><span class="pre">QuantumSystem</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">temperature</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tolerance</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.0001</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">float64</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/src/core/statistics.html#ThermalEngine.calculate_thermal_density"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.core.statistics.ThermalEngine.calculate_thermal_density" title="Link to this definition"></a></dt>
<dd><p>Computes the single-particle thermal probability density <span class="math notranslate nohighlight">\(\rho_{\text{th}}(x)\)</span>.</p>
<p>States are added one at a time in ascending energy order.  Summation
halts as soon as the maximum pointwise change in <span class="math notranslate nohighlight">\(\rho(x)\)</span> after
adding the latest state is smaller than <code class="docutils literal notranslate"><span class="pre">tolerance</span></code> — the convergence
criterion from <code class="docutils literal notranslate"><span class="pre">legacy/research_prototype.ipynb</span></code>.</p>
<p>The Boltzmann factor uses <span class="math notranslate nohighlight">\(E_0\)</span> as the energy reference to
prevent floating-point underflow for large <span class="math notranslate nohighlight">\(E_n / (k_B T)\)</span>:</p>
<div class="math notranslate nohighlight">
\[w_n = e^{-(E_n - E_0)/(k_B T)}\]</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>system</strong> – A solved <a class="reference internal" href="#src.models.states.QuantumSystem" title="src.models.states.QuantumSystem"><code class="xref py py-class docutils literal notranslate"><span class="pre">QuantumSystem</span></code></a>.</p></li>
<li><p><strong>temperature</strong> – Absolute temperature <span class="math notranslate nohighlight">\(T\)</span> in dimensionless units
(same scale as <code class="docutils literal notranslate"><span class="pre">system.potential.config.kb</span></code>).</p></li>
<li><p><strong>tolerance</strong> – Maximum allowed pointwise change in <span class="math notranslate nohighlight">\(\rho(x)\)</span>
between successive state additions.  Summation stops when
this threshold is met.  Defaults to <code class="docutils literal notranslate"><span class="pre">1e-4</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>1D float64 array of shape <code class="docutils literal notranslate"><span class="pre">(n_points,)</span></code> containing
<span class="math notranslate nohighlight">\(\rho_{\text{th}}(x)\)</span>, normalised so that its trapezoid
integral over <code class="docutils literal notranslate"><span class="pre">system.x_grid</span></code> is <span class="math notranslate nohighlight">\(\approx 1\)</span>.</p>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>ValueError</strong> – If <code class="docutils literal notranslate"><span class="pre">temperature</span> <span class="pre">&lt;=</span> <span class="pre">0</span></code>.</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>At very low temperatures, only the ground state contributes
meaningfully.  At high temperatures, the sum may require all
<code class="docutils literal notranslate"><span class="pre">system.n_states</span></code> states before convergence; in that case a
<code class="docutils literal notranslate"><span class="pre">logging.DEBUG</span></code> message is emitted and all states are used.</p>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">rho</span> <span class="o">=</span> <span class="n">engine</span><span class="o">.</span><span class="n">calculate_thermal_density</span><span class="p">(</span><span class="n">system</span><span class="p">,</span> <span class="n">temperature</span><span class="o">=</span><span class="mf">10.0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">float</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">trapz</span><span class="p">(</span><span class="n">rho</span><span class="p">,</span> <span class="n">system</span><span class="o">.</span><span class="n">x_grid</span><span class="p">))</span>  <span class="c1"># ≈ 1.0</span>
<span class="go">1.0</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="src.core.statistics.ThermalEngine.get_pair_density">
<span class="sig-name descname"><span class="pre">get_pair_density</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">system</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#src.models.states.QuantumSystem" title="src.models.states.QuantumSystem"><span class="pre">QuantumSystem</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">n1</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n2</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p_type</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#src.models.statistics.ParticleType" title="src.models.statistics.ParticleType"><span class="pre">ParticleType</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">float64</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/src/core/statistics.html#ThermalEngine.get_pair_density"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.core.statistics.ThermalEngine.get_pair_density" title="Link to this definition"></a></dt>
<dd><p>Returns the two-particle spatial density <span class="math notranslate nohighlight">\(|\Psi(x_1, x_2)|^2\)</span> for a single eigenstate pair.</p>
<p>This is the <em>zero-temperature</em> building block used by
<a class="reference internal" href="#src.core.statistics.ThermalEngine.calculate_pair_density" title="src.core.statistics.ThermalEngine.calculate_pair_density"><code class="xref py py-meth docutils literal notranslate"><span class="pre">calculate_pair_density()</span></code></a>.  Calling this method directly is
useful for visualising a specific quantum state pair or verifying
the Pauli Exclusion Principle on the diagonal.</p>
<p><strong>Symmetry Requirement (Quantum Mechanics):</strong>
For <em>identical</em> particles, the total wavefunction must be (anti-)symmetric
under particle exchange (<span class="math notranslate nohighlight">\(x_1 \leftrightarrow x_2\)</span>).  The spatial
part alone determines the exchange character only when the spin state is
fixed.  Here, the spatial symmetry is enforced per the <code class="docutils literal notranslate"><span class="pre">p_type</span></code>
specification:</p>
<ul class="simple">
<li><p><strong>BOSON</strong> (<span class="math notranslate nohighlight">\(n_1 \neq n_2\)</span>):
<span class="math notranslate nohighlight">\(\Psi_S = (\phi_{n_1}(x_1)\phi_{n_2}(x_2) + \phi_{n_1}(x_2)\phi_{n_2}(x_1)) / \sqrt{2}\)</span></p></li>
<li><p><strong>FERMION</strong> (<span class="math notranslate nohighlight">\(n_1 \neq n_2\)</span>):
<span class="math notranslate nohighlight">\(\Psi_A = (\phi_{n_1}(x_1)\phi_{n_2}(x_2) - \phi_{n_1}(x_2)\phi_{n_2}(x_1)) / \sqrt{2}\)</span></p></li>
<li><p><strong>FERMION</strong> (<span class="math notranslate nohighlight">\(n_1 = n_2\)</span>):
<span class="math notranslate nohighlight">\(\Psi_A \equiv 0\)</span> — Pauli Exclusion Principle.</p></li>
<li><p><strong>BOSON</strong> (<span class="math notranslate nohighlight">\(n_1 = n_2\)</span>):
<span class="math notranslate nohighlight">\(\Psi_S = \phi_{n_1}(x_1)\phi_{n_1}(x_2)\)</span> (already normalised).</p></li>
</ul>
<p>For <a class="reference internal" href="#src.models.statistics.ParticleType.SPIN_HALF" title="src.models.statistics.ParticleType.SPIN_HALF"><code class="xref py py-data docutils literal notranslate"><span class="pre">SPIN_HALF</span></code></a> and
<a class="reference internal" href="#src.models.statistics.ParticleType.SPIN_ONE" title="src.models.statistics.ParticleType.SPIN_ONE"><code class="xref py py-data docutils literal notranslate"><span class="pre">SPIN_ONE</span></code></a>, the density is
a weighted sum of the symmetric and antisymmetric components.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>system</strong> – A solved <a class="reference internal" href="#src.models.states.QuantumSystem" title="src.models.states.QuantumSystem"><code class="xref py py-class docutils literal notranslate"><span class="pre">QuantumSystem</span></code></a>.</p></li>
<li><p><strong>n1</strong> – Zero-based index of the first eigenstate (must be in
<code class="docutils literal notranslate"><span class="pre">[0,</span> <span class="pre">system.n_states)</span></code>).</p></li>
<li><p><strong>n2</strong> – Zero-based index of the second eigenstate (must be in
<code class="docutils literal notranslate"><span class="pre">[0,</span> <span class="pre">system.n_states)</span></code>).</p></li>
<li><p><strong>p_type</strong> – The <a class="reference internal" href="#src.models.statistics.ParticleType" title="src.models.statistics.ParticleType"><code class="xref py py-class docutils literal notranslate"><span class="pre">ParticleType</span></code></a> controlling
the spatial symmetry of the pair wavefunction.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>2D float64 array of shape <code class="docutils literal notranslate"><span class="pre">(n_points,</span> <span class="pre">n_points)</span></code> where entry
<code class="docutils literal notranslate"><span class="pre">[i,</span> <span class="pre">j]</span></code> is <span class="math notranslate nohighlight">\(|\Psi(x_i, x_j)|^2\)</span>.</p>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>IndexError</strong> – If <code class="docutils literal notranslate"><span class="pre">n1</span></code> or <code class="docutils literal notranslate"><span class="pre">n2</span></code> is outside <code class="docutils literal notranslate"><span class="pre">[0,</span> <span class="pre">system.n_states)</span></code>.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-src.visualization.plotters">
<span id="visualisation"></span><h2>Visualisation<a class="headerlink" href="#module-src.visualization.plotters" title="Link to this heading"></a></h2>
<p>Professional rendering service for 1D quantum-system visualisations.</p>
<p>This module provides <a class="reference internal" href="#src.visualization.plotters.QuantumPlotter" title="src.visualization.plotters.QuantumPlotter"><code class="xref py py-class docutils literal notranslate"><span class="pre">QuantumPlotter</span></code></a>, a stateless service class that
consumes <a class="reference internal" href="#src.models.states.QuantumSystem" title="src.models.states.QuantumSystem"><code class="xref py py-class docutils literal notranslate"><span class="pre">QuantumSystem</span></code></a> objects and pre-computed
density arrays and renders publication-quality figures.</p>
<section id="design-separation-of-concerns">
<h3>Design: Separation of Concerns<a class="headerlink" href="#design-separation-of-concerns" title="Link to this heading"></a></h3>
<p>The plotter is a <em>pure rendering</em> layer.  It enforces the following contract:</p>
<ol class="arabic simple">
<li><p><strong>No physics</strong>: The plotter never instantiates a solver, a potential, or a
thermal engine.  All numerical data arrive as method arguments.</p></li>
<li><p><strong>Dependency Injection</strong>: Callers pass in the <code class="docutils literal notranslate"><span class="pre">QuantumSystem</span></code> and any
pre-computed arrays (e.g. <code class="docutils literal notranslate"><span class="pre">rho</span></code>, <code class="docutils literal notranslate"><span class="pre">rho_2p</span></code>) produced by
<a class="reference internal" href="#src.core.statistics.ThermalEngine" title="src.core.statistics.ThermalEngine"><code class="xref py py-class docutils literal notranslate"><span class="pre">ThermalEngine</span></code></a>.  The plotter is blind to how
those arrays were produced.</p></li>
<li><p><strong>Stateless rendering</strong>: Each method returns a <code class="docutils literal notranslate"><span class="pre">(Figure,</span> <span class="pre">Axes)</span></code> pair and
optionally saves to disk.  No state is accumulated between calls; the class
instance only carries style configuration.</p></li>
<li><p><strong>Back-end isolation</strong>: <code class="docutils literal notranslate"><span class="pre">matplotlib</span></code> is imported only here.  Replacing this
module with a Plotly or Bokeh implementation requires zero changes to the
physics core.</p></li>
</ol>
</section>
<section id="extensibility-notes">
<h3>Extensibility notes<a class="headerlink" href="#extensibility-notes" title="Link to this heading"></a></h3>
<ul class="simple">
<li><p>A <code class="docutils literal notranslate"><span class="pre">PlotlyQuantumPlotter</span></code> could implement the same method signatures and be
swapped in without touching <code class="docutils literal notranslate"><span class="pre">NumerovSolver</span></code> or <code class="docutils literal notranslate"><span class="pre">ThermalEngine</span></code>.</p></li>
<li><p>A headless PDF pipeline can call these methods with <code class="docutils literal notranslate"><span class="pre">save_path</span></code> set and
<code class="docutils literal notranslate"><span class="pre">plt.show()</span></code> suppressed (controlled by the <code class="docutils literal notranslate"><span class="pre">show</span></code> parameter).</p></li>
<li><p>A Jupyter widget layer can call <code class="docutils literal notranslate"><span class="pre">fig.show()</span></code> on the returned <code class="docutils literal notranslate"><span class="pre">Figure</span></code>
object after the method returns.</p></li>
</ul>
</section>
<dl class="py class">
<dt class="sig sig-object py" id="src.visualization.plotters.QuantumPlotter">
<span class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></span><span class="sig-prename descclassname"><span class="pre">src.visualization.plotters.</span></span><span class="sig-name descname"><span class="pre">QuantumPlotter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">(9.0,</span> <span class="pre">5.0)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dpi</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">150</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/visualization/plotters.html#QuantumPlotter"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.visualization.plotters.QuantumPlotter" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Stateless rendering service for 1D quantum-system visualisations.</p>
<p>Consumes pre-computed <a class="reference internal" href="#src.models.states.QuantumSystem" title="src.models.states.QuantumSystem"><code class="xref py py-class docutils literal notranslate"><span class="pre">QuantumSystem</span></code></a> objects
and density arrays; never performs any physics calculation.</p>
<p>All methods return the <code class="docutils literal notranslate"><span class="pre">(Figure,</span> <span class="pre">Axes)</span></code> pair so callers can make further
customisations before saving or displaying the figure.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>figsize</strong> – Default figure size <code class="docutils literal notranslate"><span class="pre">(width_inches,</span> <span class="pre">height_inches)</span></code> used when
a method does not override it.  Defaults to <code class="docutils literal notranslate"><span class="pre">(9,</span> <span class="pre">5)</span></code>.</p></li>
<li><p><strong>dpi</strong> – Dots-per-inch for on-screen rendering and for <code class="docutils literal notranslate"><span class="pre">save_path</span></code> output.
Defaults to <code class="docutils literal notranslate"><span class="pre">150</span></code>.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">src.core</span><span class="w"> </span><span class="kn">import</span> <span class="n">NumerovSolver</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">src.models</span><span class="w"> </span><span class="kn">import</span> <span class="n">InfiniteSquareWell</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">src.visualization</span><span class="w"> </span><span class="kn">import</span> <span class="n">QuantumPlotter</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">system</span> <span class="o">=</span> <span class="n">NumerovSolver</span><span class="p">()</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">InfiniteSquareWell</span><span class="p">(),</span> <span class="n">n_states</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plotter</span> <span class="o">=</span> <span class="n">QuantumPlotter</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plotter</span><span class="o">.</span><span class="n">plot_wavefunctions</span><span class="p">(</span><span class="n">system</span><span class="p">,</span> <span class="n">n_states</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s2">&quot;wavefunctions.png&quot;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">)</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="src.visualization.plotters.QuantumPlotter.plot_pair_density_3d">
<span class="sig-name descname"><span class="pre">plot_pair_density_3d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">system</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#src.models.states.QuantumSystem" title="src.models.states.QuantumSystem"><span class="pre">QuantumSystem</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">rho_2p</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">float64</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'Two-particle</span> <span class="pre">pair</span> <span class="pre">density</span> <span class="pre">$\\rho(x_1,</span> <span class="pre">x_2)$'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">downsample</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Path</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Figure</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Axes3D</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/src/visualization/plotters.html#QuantumPlotter.plot_pair_density_3d"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.visualization.plotters.QuantumPlotter.plot_pair_density_3d" title="Link to this definition"></a></dt>
<dd><p>Renders the two-particle density matrix as a 3D surface plot.</p>
<p>The full <code class="docutils literal notranslate"><span class="pre">(n_points</span> <span class="pre">×</span> <span class="pre">n_points)</span></code> grid is downsampled by <code class="docutils literal notranslate"><span class="pre">downsample</span></code>
before surface rendering to keep the triangle count manageable without
losing the qualitative structure of the exchange hole / bunching ridge.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>system</strong> – The solved <a class="reference internal" href="#src.models.states.QuantumSystem" title="src.models.states.QuantumSystem"><code class="xref py py-class docutils literal notranslate"><span class="pre">QuantumSystem</span></code></a>.</p></li>
<li><p><strong>rho_2p</strong> – 2D float64 array of shape <code class="docutils literal notranslate"><span class="pre">(n_points,</span> <span class="pre">n_points)</span></code>
containing <span class="math notranslate nohighlight">\(\rho(x_1, x_2)\)</span>.</p></li>
<li><p><strong>title</strong> – Figure title string (LaTeX supported).</p></li>
<li><p><strong>downsample</strong> – Keep every <code class="docutils literal notranslate"><span class="pre">downsample</span></code>-th grid point along each
axis when building the surface mesh.  <code class="docutils literal notranslate"><span class="pre">1</span></code> keeps all points
(may be slow for <code class="docutils literal notranslate"><span class="pre">n_points=600</span></code>).  Defaults to <code class="docutils literal notranslate"><span class="pre">4</span></code>.</p></li>
<li><p><strong>show</strong> – If <code class="docutils literal notranslate"><span class="pre">True</span></code>, call <code class="docutils literal notranslate"><span class="pre">plt.show()</span></code> before returning.</p></li>
<li><p><strong>save_path</strong> – Optional file path to save the figure.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Tuple <code class="docutils literal notranslate"><span class="pre">(fig,</span> <span class="pre">ax3d)</span></code> where <code class="docutils literal notranslate"><span class="pre">ax3d</span></code> is the
<code class="xref py py-class docutils literal notranslate"><span class="pre">mpl_toolkits.mplot3d.axes3d.Axes3D</span></code> instance.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="src.visualization.plotters.QuantumPlotter.plot_pair_density_heatmap">
<span class="sig-name descname"><span class="pre">plot_pair_density_heatmap</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">system</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#src.models.states.QuantumSystem" title="src.models.states.QuantumSystem"><span class="pre">QuantumSystem</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">rho_2p</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">float64</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'Two-particle</span> <span class="pre">pair</span> <span class="pre">density</span> <span class="pre">$\\rho(x_1,</span> <span class="pre">x_2)$'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Path</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Figure</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Axes</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/src/visualization/plotters.html#QuantumPlotter.plot_pair_density_heatmap"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.visualization.plotters.QuantumPlotter.plot_pair_density_heatmap" title="Link to this definition"></a></dt>
<dd><p>Renders the two-particle density matrix as a 2D <code class="docutils literal notranslate"><span class="pre">pcolormesh</span></code>.</p>
<p>The axes are normalised by <span class="math notranslate nohighlight">\(L\)</span>.  The diagonal <span class="math notranslate nohighlight">\(x_1 = x_2\)</span>
is annotated with a dashed white line so the Pauli exclusion hole (for
fermions) or the bunching ridge (for bosons) is immediately visible.</p>
<p>Well boundaries from <code class="docutils literal notranslate"><span class="pre">system.potential.get_domain()</span></code> are drawn as
thin white reference lines on both axes.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>system</strong> – The solved <a class="reference internal" href="#src.models.states.QuantumSystem" title="src.models.states.QuantumSystem"><code class="xref py py-class docutils literal notranslate"><span class="pre">QuantumSystem</span></code></a>
providing the spatial grid and potential geometry.</p></li>
<li><p><strong>rho_2p</strong> – 2D float64 array of shape <code class="docutils literal notranslate"><span class="pre">(n_points,</span> <span class="pre">n_points)</span></code>
containing <span class="math notranslate nohighlight">\(\rho(x_1, x_2)\)</span>, as returned by
<a class="reference internal" href="#src.core.statistics.ThermalEngine.calculate_pair_density" title="src.core.statistics.ThermalEngine.calculate_pair_density"><code class="xref py py-meth docutils literal notranslate"><span class="pre">calculate_pair_density()</span></code></a>
or <a class="reference internal" href="#src.core.statistics.ThermalEngine.get_pair_density" title="src.core.statistics.ThermalEngine.get_pair_density"><code class="xref py py-meth docutils literal notranslate"><span class="pre">get_pair_density()</span></code></a>.</p></li>
<li><p><strong>title</strong> – Axes title string (LaTeX supported).</p></li>
<li><p><strong>show</strong> – If <code class="docutils literal notranslate"><span class="pre">True</span></code>, call <code class="docutils literal notranslate"><span class="pre">plt.show()</span></code> before returning.</p></li>
<li><p><strong>save_path</strong> – Optional file path to save the figure.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Tuple <code class="docutils literal notranslate"><span class="pre">(fig,</span> <span class="pre">ax)</span></code>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="src.visualization.plotters.QuantumPlotter.plot_thermal_density">
<span class="sig-name descname"><span class="pre">plot_thermal_density</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">system</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#src.models.states.QuantumSystem" title="src.models.states.QuantumSystem"><span class="pre">QuantumSystem</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">rho</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">float64</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'Single-particle</span> <span class="pre">thermal</span> <span class="pre">density'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Path</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Figure</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Axes</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/src/visualization/plotters.html#QuantumPlotter.plot_thermal_density"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.visualization.plotters.QuantumPlotter.plot_thermal_density" title="Link to this definition"></a></dt>
<dd><p>Plots a single-particle thermal probability density <span class="math notranslate nohighlight">\(\rho_{\text{th}}(x)\)</span>.</p>
<p>The spatial axis is normalised by the characteristic well width
<span class="math notranslate nohighlight">\(L\)</span> from <code class="docutils literal notranslate"><span class="pre">system.potential.config.well_width</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>system</strong> – The <a class="reference internal" href="#src.models.states.QuantumSystem" title="src.models.states.QuantumSystem"><code class="xref py py-class docutils literal notranslate"><span class="pre">QuantumSystem</span></code></a> whose
<code class="docutils literal notranslate"><span class="pre">x_grid</span></code> and <code class="docutils literal notranslate"><span class="pre">potential</span></code> provide context (well width
and potential profile for the background shading).</p></li>
<li><p><strong>rho</strong> – 1D float64 array of shape <code class="docutils literal notranslate"><span class="pre">(n_points,)</span></code> containing the
thermal probability density, as returned by
<a class="reference internal" href="#src.core.statistics.ThermalEngine.calculate_thermal_density" title="src.core.statistics.ThermalEngine.calculate_thermal_density"><code class="xref py py-meth docutils literal notranslate"><span class="pre">calculate_thermal_density()</span></code></a>.</p></li>
<li><p><strong>title</strong> – Axes title string.  Supports LaTeX math notation.</p></li>
<li><p><strong>show</strong> – If <code class="docutils literal notranslate"><span class="pre">True</span></code>, call <code class="docutils literal notranslate"><span class="pre">plt.show()</span></code> before returning.</p></li>
<li><p><strong>save_path</strong> – Optional file path to save the figure.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Tuple <code class="docutils literal notranslate"><span class="pre">(fig,</span> <span class="pre">ax)</span></code>.</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">rho</span> <span class="o">=</span> <span class="n">engine</span><span class="o">.</span><span class="n">calculate_thermal_density</span><span class="p">(</span><span class="n">system</span><span class="p">,</span> <span class="n">temperature</span><span class="o">=</span><span class="mf">5.0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plotter</span><span class="o">.</span><span class="n">plot_thermal_density</span><span class="p">(</span><span class="n">system</span><span class="p">,</span> <span class="n">rho</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;$T=5.0$&quot;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="src.visualization.plotters.QuantumPlotter.plot_wavefunctions">
<span class="sig-name descname"><span class="pre">plot_wavefunctions</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">system</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#src.models.states.QuantumSystem" title="src.models.states.QuantumSystem"><span class="pre">QuantumSystem</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_states</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Path</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Figure</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Axes</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/src/visualization/plotters.html#QuantumPlotter.plot_wavefunctions"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.visualization.plotters.QuantumPlotter.plot_wavefunctions" title="Link to this definition"></a></dt>
<dd><p>Plots the first <code class="docutils literal notranslate"><span class="pre">n_states</span></code> normalised probability densities.</p>
<p>Each eigenstate <span class="math notranslate nohighlight">\(|\psi_n(x)|^2\)</span> is plotted on a shared axis
and <em>vertically offset</em> by its energy <span class="math notranslate nohighlight">\(E_n\)</span>, so the plot reads
like a textbook energy-level diagram.  The potential profile is drawn
as a shaded background for geometric context.</p>
<p>The x-axis is normalised by the well width <span class="math notranslate nohighlight">\(L\)</span> so the plot is
unit-agnostic.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>system</strong> – A solved <a class="reference internal" href="#src.models.states.QuantumSystem" title="src.models.states.QuantumSystem"><code class="xref py py-class docutils literal notranslate"><span class="pre">QuantumSystem</span></code></a>
containing at least <code class="docutils literal notranslate"><span class="pre">n_states</span></code> eigenpairs.</p></li>
<li><p><strong>n_states</strong> – Number of eigenstates to display, starting from the
ground state (<span class="math notranslate nohighlight">\(n=1\)</span>).  Must be at most
<code class="docutils literal notranslate"><span class="pre">system.n_states</span></code>.  Defaults to 3.</p></li>
<li><p><strong>show</strong> – If <code class="docutils literal notranslate"><span class="pre">True</span></code>, call <code class="docutils literal notranslate"><span class="pre">plt.show()</span></code> before returning.
Defaults to <code class="docutils literal notranslate"><span class="pre">False</span></code> for headless / notebook use.</p></li>
<li><p><strong>save_path</strong> – If provided, save the figure to this file path
before returning.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Tuple <code class="docutils literal notranslate"><span class="pre">(fig,</span> <span class="pre">ax)</span></code> for further customisation.</p>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>ValueError</strong> – If <code class="docutils literal notranslate"><span class="pre">n_states</span> <span class="pre">&gt;</span> <span class="pre">system.n_states</span></code>.</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plotter</span><span class="o">.</span><span class="n">plot_wavefunctions</span><span class="p">(</span><span class="n">system</span><span class="p">,</span> <span class="n">n_states</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s2">&quot;energy_levels.pdf&quot;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

</section>
</section>


           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2026, Pablo Sanchez, Juan Montoya.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>
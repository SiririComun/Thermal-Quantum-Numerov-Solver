

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Thermal-Quantum-Numerov-Solver Documentation &mdash; Thermal-Quantum-Numerov-Solver 1.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=03e43079" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=9edc463e" />

  
      <script src="_static/jquery.js?v=5d32c60e"></script>
      <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="_static/documentation_options.js?v=f2a433a1"></script>
      <script src="_static/doctools.js?v=fd6eb6e6"></script>
      <script src="_static/sphinx_highlight.js?v=6ffebe34"></script>
      <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}}</script>
      <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@4/tex-mml-chtml.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="#" class="icon icon-home">
            Thermal-Quantum-Numerov-Solver
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <!-- Local TOC -->
              <div class="local-toc"><ul>
<li><a class="reference internal" href="#">Thermal-Quantum-Numerov-Solver Documentation</a><ul>
<li><a class="reference internal" href="#module-src.models.config">Models (Data &amp; Physics)</a><ul>
<li><a class="reference internal" href="#src.models.config.NumericalConfig"><code class="docutils literal notranslate"><span class="pre">NumericalConfig</span></code></a><ul>
<li><a class="reference internal" href="#src.models.config.NumericalConfig.n_points"><code class="docutils literal notranslate"><span class="pre">NumericalConfig.n_points</span></code></a></li>
<li><a class="reference internal" href="#src.models.config.NumericalConfig.x_min"><code class="docutils literal notranslate"><span class="pre">NumericalConfig.x_min</span></code></a></li>
<li><a class="reference internal" href="#src.models.config.NumericalConfig.x_max"><code class="docutils literal notranslate"><span class="pre">NumericalConfig.x_max</span></code></a></li>
<li><a class="reference internal" href="#src.models.config.NumericalConfig.convergence_tolerance"><code class="docutils literal notranslate"><span class="pre">NumericalConfig.convergence_tolerance</span></code></a></li>
<li><a class="reference internal" href="#id0"><code class="docutils literal notranslate"><span class="pre">NumericalConfig.convergence_tolerance</span></code></a></li>
<li><a class="reference internal" href="#id1"><code class="docutils literal notranslate"><span class="pre">NumericalConfig.n_points</span></code></a></li>
<li><a class="reference internal" href="#id2"><code class="docutils literal notranslate"><span class="pre">NumericalConfig.x_max</span></code></a></li>
<li><a class="reference internal" href="#id3"><code class="docutils literal notranslate"><span class="pre">NumericalConfig.x_min</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#src.models.config.PhysicsConfig"><code class="docutils literal notranslate"><span class="pre">PhysicsConfig</span></code></a><ul>
<li><a class="reference internal" href="#src.models.config.PhysicsConfig.hbar"><code class="docutils literal notranslate"><span class="pre">PhysicsConfig.hbar</span></code></a></li>
<li><a class="reference internal" href="#src.models.config.PhysicsConfig.mass"><code class="docutils literal notranslate"><span class="pre">PhysicsConfig.mass</span></code></a></li>
<li><a class="reference internal" href="#src.models.config.PhysicsConfig.kb"><code class="docutils literal notranslate"><span class="pre">PhysicsConfig.kb</span></code></a></li>
<li><a class="reference internal" href="#src.models.config.PhysicsConfig.well_width"><code class="docutils literal notranslate"><span class="pre">PhysicsConfig.well_width</span></code></a></li>
<li><a class="reference internal" href="#id4"><code class="docutils literal notranslate"><span class="pre">PhysicsConfig.hbar</span></code></a></li>
<li><a class="reference internal" href="#id5"><code class="docutils literal notranslate"><span class="pre">PhysicsConfig.kb</span></code></a></li>
<li><a class="reference internal" href="#id6"><code class="docutils literal notranslate"><span class="pre">PhysicsConfig.mass</span></code></a></li>
<li><a class="reference internal" href="#id7"><code class="docutils literal notranslate"><span class="pre">PhysicsConfig.well_width</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#src.models.potentials.BasePotential"><code class="docutils literal notranslate"><span class="pre">BasePotential</span></code></a><ul>
<li><a class="reference internal" href="#src.models.potentials.BasePotential.config"><code class="docutils literal notranslate"><span class="pre">BasePotential.config</span></code></a></li>
<li><a class="reference internal" href="#id8"><code class="docutils literal notranslate"><span class="pre">BasePotential.config</span></code></a></li>
<li><a class="reference internal" href="#src.models.potentials.BasePotential.evaluate"><code class="docutils literal notranslate"><span class="pre">BasePotential.evaluate()</span></code></a></li>
<li><a class="reference internal" href="#src.models.potentials.BasePotential.get_domain"><code class="docutils literal notranslate"><span class="pre">BasePotential.get_domain()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#src.models.potentials.FiniteSquareWell"><code class="docutils literal notranslate"><span class="pre">FiniteSquareWell</span></code></a><ul>
<li><a class="reference internal" href="#src.models.potentials.FiniteSquareWell.evaluate"><code class="docutils literal notranslate"><span class="pre">FiniteSquareWell.evaluate()</span></code></a></li>
<li><a class="reference internal" href="#src.models.potentials.FiniteSquareWell.get_domain"><code class="docutils literal notranslate"><span class="pre">FiniteSquareWell.get_domain()</span></code></a></li>
<li><a class="reference internal" href="#src.models.potentials.FiniteSquareWell.v0"><code class="docutils literal notranslate"><span class="pre">FiniteSquareWell.v0</span></code></a></li>
<li><a class="reference internal" href="#src.models.potentials.FiniteSquareWell.width"><code class="docutils literal notranslate"><span class="pre">FiniteSquareWell.width</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#src.models.potentials.HarmonicPotential"><code class="docutils literal notranslate"><span class="pre">HarmonicPotential</span></code></a><ul>
<li><a class="reference internal" href="#src.models.potentials.HarmonicPotential.center"><code class="docutils literal notranslate"><span class="pre">HarmonicPotential.center</span></code></a></li>
<li><a class="reference internal" href="#src.models.potentials.HarmonicPotential.evaluate"><code class="docutils literal notranslate"><span class="pre">HarmonicPotential.evaluate()</span></code></a></li>
<li><a class="reference internal" href="#src.models.potentials.HarmonicPotential.get_domain"><code class="docutils literal notranslate"><span class="pre">HarmonicPotential.get_domain()</span></code></a></li>
<li><a class="reference internal" href="#src.models.potentials.HarmonicPotential.omega"><code class="docutils literal notranslate"><span class="pre">HarmonicPotential.omega</span></code></a></li>
<li><a class="reference internal" href="#src.models.potentials.HarmonicPotential.v0_limit"><code class="docutils literal notranslate"><span class="pre">HarmonicPotential.v0_limit</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#src.models.potentials.InfiniteSquareWell"><code class="docutils literal notranslate"><span class="pre">InfiniteSquareWell</span></code></a><ul>
<li><a class="reference internal" href="#src.models.potentials.InfiniteSquareWell.evaluate"><code class="docutils literal notranslate"><span class="pre">InfiniteSquareWell.evaluate()</span></code></a></li>
<li><a class="reference internal" href="#src.models.potentials.InfiniteSquareWell.get_domain"><code class="docutils literal notranslate"><span class="pre">InfiniteSquareWell.get_domain()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#src.models.potentials.VShapedPotential"><code class="docutils literal notranslate"><span class="pre">VShapedPotential</span></code></a><ul>
<li><a class="reference internal" href="#src.models.potentials.VShapedPotential.center"><code class="docutils literal notranslate"><span class="pre">VShapedPotential.center</span></code></a></li>
<li><a class="reference internal" href="#src.models.potentials.VShapedPotential.evaluate"><code class="docutils literal notranslate"><span class="pre">VShapedPotential.evaluate()</span></code></a></li>
<li><a class="reference internal" href="#src.models.potentials.VShapedPotential.get_domain"><code class="docutils literal notranslate"><span class="pre">VShapedPotential.get_domain()</span></code></a></li>
<li><a class="reference internal" href="#src.models.potentials.VShapedPotential.slope"><code class="docutils literal notranslate"><span class="pre">VShapedPotential.slope</span></code></a></li>
<li><a class="reference internal" href="#src.models.potentials.VShapedPotential.v0_limit"><code class="docutils literal notranslate"><span class="pre">VShapedPotential.v0_limit</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#module-src.core.solvers">Core Engine (Solvers)</a><ul>
<li><a class="reference internal" href="#mathematical-background">Mathematical Background</a></li>
<li><a class="reference internal" href="#src.core.solvers.BaseSolver"><code class="docutils literal notranslate"><span class="pre">BaseSolver</span></code></a><ul>
<li><a class="reference internal" href="#src.core.solvers.BaseSolver.solve"><code class="docutils literal notranslate"><span class="pre">BaseSolver.solve()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#src.core.solvers.NumerovSolver"><code class="docutils literal notranslate"><span class="pre">NumerovSolver</span></code></a><ul>
<li><a class="reference internal" href="#src.core.solvers.NumerovSolver.config"><code class="docutils literal notranslate"><span class="pre">NumerovSolver.config</span></code></a></li>
<li><a class="reference internal" href="#id9"><code class="docutils literal notranslate"><span class="pre">NumerovSolver.config</span></code></a></li>
<li><a class="reference internal" href="#src.core.solvers.NumerovSolver.solve"><code class="docutils literal notranslate"><span class="pre">NumerovSolver.solve()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="#">Thermal-Quantum-Numerov-Solver</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="#" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Thermal-Quantum-Numerov-Solver Documentation</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/index.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="thermal-quantum-numerov-solver-documentation">
<h1>Thermal-Quantum-Numerov-Solver Documentation<a class="headerlink" href="#thermal-quantum-numerov-solver-documentation" title="Link to this heading"></a></h1>
<div class="toctree-wrapper compound">
</div>
<section id="module-src.models.config">
<span id="models-data-physics"></span><h2>Models (Data &amp; Physics)<a class="headerlink" href="#module-src.models.config" title="Link to this heading"></a></h2>
<p>Configuration dataclasses for dimensionless Schrödinger simulations.</p>
<p>The legacy notebook uses reduced (dimensionless) units where:
- <span class="math notranslate nohighlight">\(\hbar = 1\)</span>
- <span class="math notranslate nohighlight">\(m = 0.5\)</span>
- <span class="math notranslate nohighlight">\(k_B = 1\)</span>
- <span class="math notranslate nohighlight">\(L = \pi\)</span></p>
<p>These values make the infinite-well reference spectrum satisfy
<span class="math notranslate nohighlight">\(E_n = n^2\)</span> in units of the ground-state energy scale.</p>
<dl class="py class">
<dt class="sig sig-object py" id="src.models.config.NumericalConfig">
<span class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></span><span class="sig-prename descclassname"><span class="pre">src.models.config.</span></span><span class="sig-name descname"><span class="pre">NumericalConfig</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_points</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">600</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x_min</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">-1.5707963267948966</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x_max</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">4.71238898038469</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">convergence_tolerance</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.0001</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/models/config.html#NumericalConfig"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.models.config.NumericalConfig" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Numerical discretization and convergence controls in reduced units.</p>
<p>The default spatial interval reproduces the legacy grid construction:
<span class="math notranslate nohighlight">\(x \in [-\pi/2,\, 3\pi/2]\)</span> with 600 points. Convergence tolerance is the
dimensionless threshold used for thermal-sum stopping criteria.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="src.models.config.NumericalConfig.n_points">
<span class="sig-name descname"><span class="pre">n_points</span></span><a class="headerlink" href="#src.models.config.NumericalConfig.n_points" title="Link to this definition"></a></dt>
<dd><p>Total number of grid points for the spatial discretization.
Dimensionless count (unitless). Default is 600.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="src.models.config.NumericalConfig.x_min">
<span class="sig-name descname"><span class="pre">x_min</span></span><a class="headerlink" href="#src.models.config.NumericalConfig.x_min" title="Link to this definition"></a></dt>
<dd><p>Left boundary of the spatial domain in dimensionless length
units. Default is <span class="math notranslate nohighlight">\(-\pi/2\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="src.models.config.NumericalConfig.x_max">
<span class="sig-name descname"><span class="pre">x_max</span></span><a class="headerlink" href="#src.models.config.NumericalConfig.x_max" title="Link to this definition"></a></dt>
<dd><p>Right boundary of the spatial domain in dimensionless length
units. Default is <span class="math notranslate nohighlight">\(3\pi/2\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="src.models.config.NumericalConfig.convergence_tolerance">
<span class="sig-name descname"><span class="pre">convergence_tolerance</span></span><a class="headerlink" href="#src.models.config.NumericalConfig.convergence_tolerance" title="Link to this definition"></a></dt>
<dd><p>Maximum allowed absolute change in consecutive
thermal-density estimates, in dimensionless probability-density
units. Default is <span class="math notranslate nohighlight">\(10^{-4}\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id0">
<span class="sig-name descname"><span class="pre">convergence_tolerance</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></span><a class="headerlink" href="#id0" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id1">
<span class="sig-name descname"><span class="pre">n_points</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></span><a class="headerlink" href="#id1" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id2">
<span class="sig-name descname"><span class="pre">x_max</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></span><a class="headerlink" href="#id2" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id3">
<span class="sig-name descname"><span class="pre">x_min</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></span><a class="headerlink" href="#id3" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="src.models.config.PhysicsConfig">
<span class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></span><span class="sig-prename descclassname"><span class="pre">src.models.config.</span></span><span class="sig-name descname"><span class="pre">PhysicsConfig</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hbar</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mass</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kb</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">well_width</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">3.141592653589793</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/models/config.html#PhysicsConfig"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.models.config.PhysicsConfig" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Physical constants in dimensionless units from the legacy prototype.</p>
<p>The values match the normalization used in
legacy/research_prototype.ipynb so that the 1D infinite square-well
reference has energies <span class="math notranslate nohighlight">\(E_n = n^2\)</span>.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="src.models.config.PhysicsConfig.hbar">
<span class="sig-name descname"><span class="pre">hbar</span></span><a class="headerlink" href="#src.models.config.PhysicsConfig.hbar" title="Link to this definition"></a></dt>
<dd><p>Reduced Planck constant in dimensionless units. Default is 1.0.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="src.models.config.PhysicsConfig.mass">
<span class="sig-name descname"><span class="pre">mass</span></span><a class="headerlink" href="#src.models.config.PhysicsConfig.mass" title="Link to this definition"></a></dt>
<dd><p>Particle mass in dimensionless units. Default is 0.5, which
enforces <span class="math notranslate nohighlight">\(\hbar^2/(2m)=1\)</span> when <cite>hbar=1</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="src.models.config.PhysicsConfig.kb">
<span class="sig-name descname"><span class="pre">kb</span></span><a class="headerlink" href="#src.models.config.PhysicsConfig.kb" title="Link to this definition"></a></dt>
<dd><p>Boltzmann constant in dimensionless thermal units. Default is 1.0,
so reduced temperature is directly represented as <span class="math notranslate nohighlight">\(t = k_B T\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="src.models.config.PhysicsConfig.well_width">
<span class="sig-name descname"><span class="pre">well_width</span></span><a class="headerlink" href="#src.models.config.PhysicsConfig.well_width" title="Link to this definition"></a></dt>
<dd><p>Characteristic well width <span class="math notranslate nohighlight">\(L\)</span> in dimensionless length units.
Default is <span class="math notranslate nohighlight">\(\pi\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id4">
<span class="sig-name descname"><span class="pre">hbar</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></span><a class="headerlink" href="#id4" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id5">
<span class="sig-name descname"><span class="pre">kb</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></span><a class="headerlink" href="#id5" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id6">
<span class="sig-name descname"><span class="pre">mass</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></span><a class="headerlink" href="#id6" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id7">
<span class="sig-name descname"><span class="pre">well_width</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></span><a class="headerlink" href="#id7" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<p id="module-src.models.potentials">Abstract base class and concrete implementations for 1D quantum potentials.</p>
<p>This module defines the <code class="docutils literal notranslate"><span class="pre">BasePotential</span></code> interface and four concrete
subclasses that faithfully reproduce the potential functions found in
<code class="docutils literal notranslate"><span class="pre">legacy/research_prototype.ipynb</span></code>:</p>
<ul class="simple">
<li><p><a class="reference internal" href="#src.models.potentials.InfiniteSquareWell" title="src.models.potentials.InfiniteSquareWell"><code class="xref py py-class docutils literal notranslate"><span class="pre">InfiniteSquareWell</span></code></a> — Analytical infinite-barrier box.</p></li>
<li><p><a class="reference internal" href="#src.models.potentials.FiniteSquareWell" title="src.models.potentials.FiniteSquareWell"><code class="xref py py-class docutils literal notranslate"><span class="pre">FiniteSquareWell</span></code></a>   — Flat-bottom well with finite barriers.</p></li>
<li><p><a class="reference internal" href="#src.models.potentials.HarmonicPotential" title="src.models.potentials.HarmonicPotential"><code class="xref py py-class docutils literal notranslate"><span class="pre">HarmonicPotential</span></code></a>  — Truncated harmonic oscillator (parabolic).</p></li>
<li><p><a class="reference internal" href="#src.models.potentials.VShapedPotential" title="src.models.potentials.VShapedPotential"><code class="xref py py-class docutils literal notranslate"><span class="pre">VShapedPotential</span></code></a>   — Truncated V-shape (linear) potential.</p></li>
</ul>
<p>All subclasses accept a <a class="reference internal" href="#src.models.config.PhysicsConfig" title="src.models.config.PhysicsConfig"><code class="xref py py-class docutils literal notranslate"><span class="pre">PhysicsConfig</span></code></a> object
for their physical constants, enforcing Dependency Injection and eliminating
global-constant coupling.</p>
<dl class="py class">
<dt class="sig sig-object py" id="src.models.potentials.BasePotential">
<span class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></span><span class="sig-prename descclassname"><span class="pre">src.models.potentials.</span></span><span class="sig-name descname"><span class="pre">BasePotential</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#src.models.config.PhysicsConfig" title="src.models.config.PhysicsConfig"><span class="pre">PhysicsConfig</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/models/potentials.html#BasePotential"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.models.potentials.BasePotential" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">ABC</span></code></p>
<p>Abstract interface for all 1D quantum potential definitions.</p>
<p>Every potential that participates in the Numerov eigenvalue pipeline must
implement this contract.  The <code class="xref py py-class docutils literal notranslate"><span class="pre">NumerovSolver</span></code>
depends <em>only</em> on this interface, so new geometries (e.g. a double well)
can be added in a new subclass without ever modifying the solver — in
strict compliance with the Open-Closed Principle.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>config</strong> – Frozen dataclass holding the dimensionless physical constants
(<code class="docutils literal notranslate"><span class="pre">hbar</span></code>, <code class="docutils literal notranslate"><span class="pre">mass</span></code>, <code class="docutils literal notranslate"><span class="pre">kb</span></code>, <code class="docutils literal notranslate"><span class="pre">well_width</span></code>) used throughout the
simulation.  Defaults to the standard reduced-unit set
(<code class="docutils literal notranslate"><span class="pre">hbar=1</span></code>, <code class="docutils literal notranslate"><span class="pre">mass=0.5</span></code>, <code class="docutils literal notranslate"><span class="pre">L=pi</span></code>) that makes the infinite-well
spectrum satisfy <span class="math notranslate nohighlight">\(E_n = n^2\)</span>.</p>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="src.models.potentials.BasePotential.config">
<span class="sig-name descname"><span class="pre">config</span></span><a class="headerlink" href="#src.models.potentials.BasePotential.config" title="Link to this definition"></a></dt>
<dd><p>Read-only reference to the injected <code class="xref py py-class docutils literal notranslate"><span class="pre">PhysicsConfig</span></code>.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="id8">
<span class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">config</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#src.models.config.PhysicsConfig" title="src.models.config.PhysicsConfig"><span class="pre">PhysicsConfig</span></a></span><a class="headerlink" href="#id8" title="Link to this definition"></a></dt>
<dd><p>The injected physics constants, read-only.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#src.models.config.PhysicsConfig" title="src.models.config.PhysicsConfig">PhysicsConfig</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="src.models.potentials.BasePotential.evaluate">
<span class="property"><span class="k"><span class="pre">abstractmethod</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">evaluate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">float64</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">float64</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/src/models/potentials.html#BasePotential.evaluate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.models.potentials.BasePotential.evaluate" title="Link to this definition"></a></dt>
<dd><p>Evaluates the potential energy <span class="math notranslate nohighlight">\(V(x)\)</span> at each grid point.</p>
<p>This is the primary contract method consumed by the Numerov solver.
All values are returned in dimensionless energy units of <span class="math notranslate nohighlight">\(E_1\)</span>,
where <span class="math notranslate nohighlight">\(E_1 = \hbar^2 / (2m)\)</span> with the defaults <code class="docutils literal notranslate"><span class="pre">hbar=1</span></code>,
<code class="docutils literal notranslate"><span class="pre">mass=0.5</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x</strong> – 1D array of spatial coordinates in dimensionless length units
(e.g. <span class="math notranslate nohighlight">\(x/L\)</span> or literal position when <span class="math notranslate nohighlight">\(L = \pi\)</span>).</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>1D float64 array with the same shape as <code class="docutils literal notranslate"><span class="pre">x</span></code> containing
<span class="math notranslate nohighlight">\(V(x)\)</span> values.  Barrier regions may contain <code class="docutils literal notranslate"><span class="pre">np.inf</span></code>
for infinite-wall geometries.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="src.models.potentials.BasePotential.get_domain">
<span class="property"><span class="k"><span class="pre">abstractmethod</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">get_domain</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/src/models/potentials.html#BasePotential.get_domain"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.models.potentials.BasePotential.get_domain" title="Link to this definition"></a></dt>
<dd><p>Returns the recommended spatial domain <span class="math notranslate nohighlight">\([x_{min}, x_{max}]\)</span>.</p>
<p>The Numerov solver calls this method to build the spatial grid without
any hardcoded geometry knowledge.  The domain should comfortably
contain both the classically allowed region and (for finite barriers)
the evanescent tunnelling tails.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>A <code class="docutils literal notranslate"><span class="pre">(x_min,</span> <span class="pre">x_max)</span></code> tuple in dimensionless length units.</p>
</dd>
</dl>
<p class="rubric">Example</p>
<p>A finite well of width <span class="math notranslate nohighlight">\(L = \pi\)</span> returns:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">well</span> <span class="o">=</span> <span class="n">FiniteSquareWell</span><span class="p">(</span><span class="n">v0</span><span class="o">=</span><span class="mf">10.0</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="n">math</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">well</span><span class="o">.</span><span class="n">get_domain</span><span class="p">()</span>
<span class="go">(-1.5707963267948966, 4.71238898038469)</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="src.models.potentials.FiniteSquareWell">
<span class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></span><span class="sig-prename descclassname"><span class="pre">src.models.potentials.</span></span><span class="sig-name descname"><span class="pre">FiniteSquareWell</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">v0</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">width</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">config</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#src.models.config.PhysicsConfig" title="src.models.config.PhysicsConfig"><span class="pre">PhysicsConfig</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/models/potentials.html#FiniteSquareWell"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.models.potentials.FiniteSquareWell" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#src.models.potentials.BasePotential" title="src.models.potentials.BasePotential"><code class="xref py py-class docutils literal notranslate"><span class="pre">BasePotential</span></code></a></p>
<p>Finite square-well potential with flat barriers.</p>
<p>Faithfully reproduces <code class="docutils literal notranslate"><span class="pre">get_potential(x,</span> <span class="pre">V0,</span> <span class="pre">well_width)</span></code> from
<code class="docutils literal notranslate"><span class="pre">legacy/research_prototype.ipynb</span></code>.</p>
<p>The potential is defined as:</p>
<div class="math notranslate nohighlight">
\[\begin{split}V(x) =
\begin{cases}
    0    &amp; \text{if } 0 \le x \le w \\
    V_0  &amp; \text{otherwise}
\end{cases}\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(w\)</span> is the <code class="docutils literal notranslate"><span class="pre">width</span></code> parameter and <span class="math notranslate nohighlight">\(V_0\)</span> is the
barrier height.</p>
<p>The returned domain adds a half-width margin on the left and a
full-width margin on the right — identical to the legacy constants
<code class="docutils literal notranslate"><span class="pre">X_MIN</span> <span class="pre">=</span> <span class="pre">-L/2</span></code>, <code class="docutils literal notranslate"><span class="pre">X_MAX</span> <span class="pre">=</span> <span class="pre">3L/2</span></code> — to capture the evanescent
tunnelling tails that extend into the barrier region.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>v0</strong> – Barrier height in dimensionless energy units of <span class="math notranslate nohighlight">\(E_1\)</span>.
The legacy study uses <code class="docutils literal notranslate"><span class="pre">v0</span> <span class="pre">∈</span> <span class="pre">{10,</span> <span class="pre">50,</span> <span class="pre">1000}</span></code>.</p></li>
<li><p><strong>width</strong> – Well width in dimensionless length units.  Defaults to
<code class="docutils literal notranslate"><span class="pre">config.well_width</span></code> (i.e. <span class="math notranslate nohighlight">\(\pi\)</span>) when <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p></li>
<li><p><strong>config</strong> – Physics constants.  Reads <code class="docutils literal notranslate"><span class="pre">well_width</span></code> as the fallback
when <code class="docutils literal notranslate"><span class="pre">width</span></code> is not provided.</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – If <code class="docutils literal notranslate"><span class="pre">v0</span> <span class="pre">&lt;</span> <span class="pre">0</span></code> or <code class="docutils literal notranslate"><span class="pre">width</span> <span class="pre">&lt;=</span> <span class="pre">0</span></code>.</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">well</span> <span class="o">=</span> <span class="n">FiniteSquareWell</span><span class="p">(</span><span class="n">v0</span><span class="o">=</span><span class="mf">10.0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">+</span> <span class="mf">0.5</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">well</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="go">array([10. ,  0. ,  0. ,  0. , 10. ])</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="src.models.potentials.FiniteSquareWell.evaluate">
<span class="sig-name descname"><span class="pre">evaluate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">float64</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">float64</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/src/models/potentials.html#FiniteSquareWell.evaluate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.models.potentials.FiniteSquareWell.evaluate" title="Link to this definition"></a></dt>
<dd><p>Returns <span class="math notranslate nohighlight">\(V(x) = 0\)</span> inside <span class="math notranslate nohighlight">\([0, w]\)</span>, <span class="math notranslate nohighlight">\(V_0\)</span> outside.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x</strong> – 1D array of spatial coordinates in dimensionless length units.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Float64 array of the same shape as <code class="docutils literal notranslate"><span class="pre">x</span></code>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="src.models.potentials.FiniteSquareWell.get_domain">
<span class="sig-name descname"><span class="pre">get_domain</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/src/models/potentials.html#FiniteSquareWell.get_domain"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.models.potentials.FiniteSquareWell.get_domain" title="Link to this definition"></a></dt>
<dd><p>Returns the extended domain <span class="math notranslate nohighlight">\([-w/2,\, 3w/2]\)</span>.</p>
<p>The half-width left margin and full-width right margin replicate the
legacy grid <code class="docutils literal notranslate"><span class="pre">X_MIN</span> <span class="pre">=</span> <span class="pre">-L/2</span></code>, <code class="docutils literal notranslate"><span class="pre">X_MAX</span> <span class="pre">=</span> <span class="pre">3L/2</span></code>, ensuring sufficient
room for the evanescent wave tails to decay to zero.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The tuple <code class="docutils literal notranslate"><span class="pre">(-width/2,</span> <span class="pre">3*width/2)</span></code>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="src.models.potentials.FiniteSquareWell.v0">
<span class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">v0</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></span><a class="headerlink" href="#src.models.potentials.FiniteSquareWell.v0" title="Link to this definition"></a></dt>
<dd><p>Barrier height in dimensionless energy units.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="src.models.potentials.FiniteSquareWell.width">
<span class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">width</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></span><a class="headerlink" href="#src.models.potentials.FiniteSquareWell.width" title="Link to this definition"></a></dt>
<dd><p>Well width in dimensionless length units.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="src.models.potentials.HarmonicPotential">
<span class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></span><span class="sig-prename descclassname"><span class="pre">src.models.potentials.</span></span><span class="sig-name descname"><span class="pre">HarmonicPotential</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">omega</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">2.2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">v0_limit</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">60.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">center</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1.5707963267948966</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">config</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#src.models.config.PhysicsConfig" title="src.models.config.PhysicsConfig"><span class="pre">PhysicsConfig</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/models/potentials.html#HarmonicPotential"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.models.potentials.HarmonicPotential" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#src.models.potentials.BasePotential" title="src.models.potentials.BasePotential"><code class="xref py py-class docutils literal notranslate"><span class="pre">BasePotential</span></code></a></p>
<p>Truncated harmonic oscillator (parabolic) potential.</p>
<p>Faithfully reproduces <code class="docutils literal notranslate"><span class="pre">potential_harmonic_finite(x,</span> <span class="pre">V0,</span> <span class="pre">omega,</span> <span class="pre">center)</span></code>
from <code class="docutils literal notranslate"><span class="pre">legacy/research_prototype.ipynb</span></code>.</p>
<p>The potential is defined as:</p>
<div class="math notranslate nohighlight">
\[V(x) = \min\!\left(\frac{1}{2} m\,\omega^2 (x - x_c)^2,\; V_{\rm lim}\right)\]</div>
<p>where <span class="math notranslate nohighlight">\(m\)</span> = <code class="docutils literal notranslate"><span class="pre">config.mass</span></code>, <span class="math notranslate nohighlight">\(\omega\)</span> is the angular
frequency, <span class="math notranslate nohighlight">\(x_c\)</span> is the well centre, and <span class="math notranslate nohighlight">\(V_{\rm lim}\)</span> is
the truncation ceiling.  Truncation ensures finite barrier heights for
numerical tractability without unphysical divergence.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>omega</strong> – Angular frequency <span class="math notranslate nohighlight">\(\omega\)</span> in dimensionless units.
Legacy default is <code class="docutils literal notranslate"><span class="pre">2.2</span></code>.</p></li>
<li><p><strong>v0_limit</strong> – Truncation ceiling <span class="math notranslate nohighlight">\(V_{\rm lim}\)</span> in dimensionless
energy units.  Legacy default is <code class="docutils literal notranslate"><span class="pre">60.0</span></code>.</p></li>
<li><p><strong>center</strong> – Position of the parabolic minimum <span class="math notranslate nohighlight">\(x_c\)</span> in
dimensionless length units.  Legacy default is <span class="math notranslate nohighlight">\(\pi/2\)</span>.</p></li>
<li><p><strong>config</strong> – Physics constants.  Reads <code class="docutils literal notranslate"><span class="pre">mass</span></code> for the prefactor
<span class="math notranslate nohighlight">\(\frac{1}{2} m \omega^2\)</span>.</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – If <code class="docutils literal notranslate"><span class="pre">omega</span> <span class="pre">&lt;=</span> <span class="pre">0</span></code> or <code class="docutils literal notranslate"><span class="pre">v0_limit</span> <span class="pre">&lt;=</span> <span class="pre">0</span></code>.</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span><span class="o">,</span><span class="w"> </span><span class="nn">math</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pot</span> <span class="o">=</span> <span class="n">HarmonicPotential</span><span class="p">(</span><span class="n">omega</span><span class="o">=</span><span class="mf">2.2</span><span class="p">,</span> <span class="n">v0_limit</span><span class="o">=</span><span class="mf">60.0</span><span class="p">,</span> <span class="n">center</span><span class="o">=</span><span class="n">math</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pot</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">math</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">2</span><span class="p">]))</span>   <span class="c1"># minimum at centre</span>
<span class="go">array([0.])</span>
</pre></div>
</div>
<dl class="py property">
<dt class="sig sig-object py" id="src.models.potentials.HarmonicPotential.center">
<span class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">center</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></span><a class="headerlink" href="#src.models.potentials.HarmonicPotential.center" title="Link to this definition"></a></dt>
<dd><p>Position of the parabolic minimum in dimensionless length units.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="src.models.potentials.HarmonicPotential.evaluate">
<span class="sig-name descname"><span class="pre">evaluate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">float64</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">float64</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/src/models/potentials.html#HarmonicPotential.evaluate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.models.potentials.HarmonicPotential.evaluate" title="Link to this definition"></a></dt>
<dd><p>Returns <span class="math notranslate nohighlight">\(V(x) = \min(\tfrac{1}{2}m\omega^2(x-x_c)^2,\, V_{\rm lim})\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x</strong> – 1D array of spatial coordinates in dimensionless length units.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Float64 array of the same shape as <code class="docutils literal notranslate"><span class="pre">x</span></code>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="src.models.potentials.HarmonicPotential.get_domain">
<span class="sig-name descname"><span class="pre">get_domain</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/src/models/potentials.html#HarmonicPotential.get_domain"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.models.potentials.HarmonicPotential.get_domain" title="Link to this definition"></a></dt>
<dd><p>Returns a domain that fully contains both well and barrier regions.</p>
<p>The truncation radius <span class="math notranslate nohighlight">\(r_t = \sqrt{2 V_{\rm lim} / (m\omega^2)}\)</span>
is the distance from the centre at which the parabola reaches
<span class="math notranslate nohighlight">\(V_{\rm lim}\)</span>.  A 50 % safety margin is added to ensure
the evanescent tail decays to zero within the grid.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The tuple <code class="docutils literal notranslate"><span class="pre">(center</span> <span class="pre">-</span> <span class="pre">1.5*r_t,</span> <span class="pre">center</span> <span class="pre">+</span> <span class="pre">1.5*r_t)</span></code>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="src.models.potentials.HarmonicPotential.omega">
<span class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">omega</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></span><a class="headerlink" href="#src.models.potentials.HarmonicPotential.omega" title="Link to this definition"></a></dt>
<dd><p>Angular frequency in dimensionless units.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="src.models.potentials.HarmonicPotential.v0_limit">
<span class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">v0_limit</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></span><a class="headerlink" href="#src.models.potentials.HarmonicPotential.v0_limit" title="Link to this definition"></a></dt>
<dd><p>Truncation ceiling in dimensionless energy units.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="src.models.potentials.InfiniteSquareWell">
<span class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></span><span class="sig-prename descclassname"><span class="pre">src.models.potentials.</span></span><span class="sig-name descname"><span class="pre">InfiniteSquareWell</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#src.models.config.PhysicsConfig" title="src.models.config.PhysicsConfig"><span class="pre">PhysicsConfig</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/models/potentials.html#InfiniteSquareWell"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.models.potentials.InfiniteSquareWell" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#src.models.potentials.BasePotential" title="src.models.potentials.BasePotential"><code class="xref py py-class docutils literal notranslate"><span class="pre">BasePotential</span></code></a></p>
<p>Infinite square-well potential with exact Dirichlet boundary conditions.</p>
<p>The potential is defined as:</p>
<div class="math notranslate nohighlight">
\[\begin{split}V(x) =
\begin{cases}
    0       &amp; \text{if } 0 \le x \le L \\
    +\infty &amp; \text{otherwise}
\end{cases}\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(L\)</span> = <code class="docutils literal notranslate"><span class="pre">config.well_width</span></code> (default <span class="math notranslate nohighlight">\(\pi\)</span>).</p>
<p>This geometry has an exact analytical eigenspectrum given by
<span class="math notranslate nohighlight">\(E_n = n^2\)</span> in the dimensionless unit system (<code class="docutils literal notranslate"><span class="pre">hbar=1</span></code>,
<code class="docutils literal notranslate"><span class="pre">mass=0.5</span></code>, <span class="math notranslate nohighlight">\(L=\pi\)</span>), which is used as the reference baseline
throughout the project.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>config</strong> – Physics constants.  Reads <code class="docutils literal notranslate"><span class="pre">well_width</span></code> to locate the right
wall of the box.</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">well</span> <span class="o">=</span> <span class="n">InfiniteSquareWell</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">+</span> <span class="mf">0.1</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">well</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="go">array([inf,  0.,  0.,  0., inf])</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="src.models.potentials.InfiniteSquareWell.evaluate">
<span class="sig-name descname"><span class="pre">evaluate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">float64</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">float64</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/src/models/potentials.html#InfiniteSquareWell.evaluate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.models.potentials.InfiniteSquareWell.evaluate" title="Link to this definition"></a></dt>
<dd><p>Returns <span class="math notranslate nohighlight">\(V(x)\)</span> with <span class="math notranslate nohighlight">\(+\infty\)</span> walls at <span class="math notranslate nohighlight">\(x=0\)</span> and <span class="math notranslate nohighlight">\(x=L\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x</strong> – 1D array of spatial coordinates in dimensionless length units.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Float64 array of the same shape as <code class="docutils literal notranslate"><span class="pre">x</span></code>.  Values outside
<span class="math notranslate nohighlight">\([0, L]\)</span> are set to <code class="docutils literal notranslate"><span class="pre">np.inf</span></code>; values inside are <code class="docutils literal notranslate"><span class="pre">0.0</span></code>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="src.models.potentials.InfiniteSquareWell.get_domain">
<span class="sig-name descname"><span class="pre">get_domain</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/src/models/potentials.html#InfiniteSquareWell.get_domain"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.models.potentials.InfiniteSquareWell.get_domain" title="Link to this definition"></a></dt>
<dd><p>Returns <span class="math notranslate nohighlight">\([0, L]\)</span> — the exact physical domain of the box.</p>
<p>The solver requires Dirichlet conditions at both ends, so no external
margin is needed.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The tuple <code class="docutils literal notranslate"><span class="pre">(0.0,</span> <span class="pre">well_width)</span></code>.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="src.models.potentials.VShapedPotential">
<span class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></span><span class="sig-prename descclassname"><span class="pre">src.models.potentials.</span></span><span class="sig-name descname"><span class="pre">VShapedPotential</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">slope</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">28.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">v0_limit</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">60.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">center</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1.5707963267948966</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">config</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#src.models.config.PhysicsConfig" title="src.models.config.PhysicsConfig"><span class="pre">PhysicsConfig</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/models/potentials.html#VShapedPotential"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.models.potentials.VShapedPotential" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#src.models.potentials.BasePotential" title="src.models.potentials.BasePotential"><code class="xref py py-class docutils literal notranslate"><span class="pre">BasePotential</span></code></a></p>
<p>Truncated V-shape (linear) potential.</p>
<p>Faithfully reproduces <code class="docutils literal notranslate"><span class="pre">potential_vshape_finite(x,</span> <span class="pre">V0,</span> <span class="pre">slope,</span> <span class="pre">center)</span></code>
from <code class="docutils literal notranslate"><span class="pre">legacy/research_prototype.ipynb</span></code>.</p>
<p>The potential is defined as:</p>
<div class="math notranslate nohighlight">
\[V(x) = \min\!\left(s\,|x - x_c|,\; V_{\rm lim}\right)\]</div>
<p>where <span class="math notranslate nohighlight">\(s\)</span> is the linear slope, <span class="math notranslate nohighlight">\(x_c\)</span> is the cusp centre,
and <span class="math notranslate nohighlight">\(V_{\rm lim}\)</span> is the truncation ceiling.  The result is a
tent-shaped well with flat barriers once the slope reaches
<span class="math notranslate nohighlight">\(V_{\rm lim}\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>slope</strong> – Linear slope <span class="math notranslate nohighlight">\(s\)</span> in dimensionless energy-per-length
units.  Legacy default is <code class="docutils literal notranslate"><span class="pre">28.0</span></code>.</p></li>
<li><p><strong>v0_limit</strong> – Truncation ceiling <span class="math notranslate nohighlight">\(V_{\rm lim}\)</span> in dimensionless
energy units.  Legacy default is <code class="docutils literal notranslate"><span class="pre">60.0</span></code>.</p></li>
<li><p><strong>center</strong> – Position of the V-cusp <span class="math notranslate nohighlight">\(x_c\)</span> in dimensionless length
units.  Legacy default is <span class="math notranslate nohighlight">\(\pi/2\)</span>.</p></li>
<li><p><strong>config</strong> – Physics constants dataclass.  Not required to evaluate this
potential (no mass dependency), but accepted for interface
consistency.</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – If <code class="docutils literal notranslate"><span class="pre">slope</span> <span class="pre">&lt;=</span> <span class="pre">0</span></code> or <code class="docutils literal notranslate"><span class="pre">v0_limit</span> <span class="pre">&lt;=</span> <span class="pre">0</span></code>.</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span><span class="o">,</span><span class="w"> </span><span class="nn">math</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pot</span> <span class="o">=</span> <span class="n">VShapedPotential</span><span class="p">(</span><span class="n">slope</span><span class="o">=</span><span class="mf">28.0</span><span class="p">,</span> <span class="n">v0_limit</span><span class="o">=</span><span class="mf">60.0</span><span class="p">,</span> <span class="n">center</span><span class="o">=</span><span class="n">math</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pot</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">math</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">2</span><span class="p">]))</span>   <span class="c1"># cusp — minimum is zero</span>
<span class="go">array([0.])</span>
</pre></div>
</div>
<dl class="py property">
<dt class="sig sig-object py" id="src.models.potentials.VShapedPotential.center">
<span class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">center</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></span><a class="headerlink" href="#src.models.potentials.VShapedPotential.center" title="Link to this definition"></a></dt>
<dd><p>Cusp position in dimensionless length units.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="src.models.potentials.VShapedPotential.evaluate">
<span class="sig-name descname"><span class="pre">evaluate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">float64</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">float64</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/src/models/potentials.html#VShapedPotential.evaluate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.models.potentials.VShapedPotential.evaluate" title="Link to this definition"></a></dt>
<dd><p>Returns <span class="math notranslate nohighlight">\(V(x) = \min(s\,|x - x_c|,\, V_{\rm lim})\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x</strong> – 1D array of spatial coordinates in dimensionless length units.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Float64 array of the same shape as <code class="docutils literal notranslate"><span class="pre">x</span></code>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="src.models.potentials.VShapedPotential.get_domain">
<span class="sig-name descname"><span class="pre">get_domain</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/src/models/potentials.html#VShapedPotential.get_domain"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.models.potentials.VShapedPotential.get_domain" title="Link to this definition"></a></dt>
<dd><p>Returns a domain that fully contains the well and flat barriers.</p>
<p>The truncation radius <span class="math notranslate nohighlight">\(r_t = V_{\rm lim} / s\)</span> is the distance
from the cusp at which the slope reaches <span class="math notranslate nohighlight">\(V_{\rm lim}\)</span>.  A
50 % safety margin is added for the evanescent tails.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The tuple <code class="docutils literal notranslate"><span class="pre">(center</span> <span class="pre">-</span> <span class="pre">1.5*r_t,</span> <span class="pre">center</span> <span class="pre">+</span> <span class="pre">1.5*r_t)</span></code>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="src.models.potentials.VShapedPotential.slope">
<span class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">slope</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></span><a class="headerlink" href="#src.models.potentials.VShapedPotential.slope" title="Link to this definition"></a></dt>
<dd><p>Linear slope in dimensionless energy-per-length units.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="src.models.potentials.VShapedPotential.v0_limit">
<span class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">v0_limit</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></span><a class="headerlink" href="#src.models.potentials.VShapedPotential.v0_limit" title="Link to this definition"></a></dt>
<dd><p>Truncation ceiling in dimensionless energy units.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-src.core.solvers">
<span id="core-engine-solvers"></span><h2>Core Engine (Solvers)<a class="headerlink" href="#module-src.core.solvers" title="Link to this heading"></a></h2>
<p>Matrix Numerov eigenvalue solver for the 1D Time-Independent Schrödinger Equation.</p>
<p>This module provides the <a class="reference internal" href="#src.core.solvers.NumerovSolver" title="src.core.solvers.NumerovSolver"><code class="xref py py-class docutils literal notranslate"><span class="pre">NumerovSolver</span></code></a> service class, which refactors
the procedural <code class="docutils literal notranslate"><span class="pre">solve_schrodinger_numerov</span></code> function from
<code class="docutils literal notranslate"><span class="pre">legacy/research_prototype.ipynb</span></code> into a production-grade engine.</p>
<section id="mathematical-background">
<h3>Mathematical Background<a class="headerlink" href="#mathematical-background" title="Link to this heading"></a></h3>
<p>The TISE in dimensionless units is:</p>
<div class="math notranslate nohighlight">
\[-\frac{\hbar^2}{2m} \frac{d^2\psi}{dx^2} + V(x)\psi = E\psi\]</div>
<p>which, after substituting the scaled variable <span class="math notranslate nohighlight">\(\varepsilon = 2mE/\hbar^2\)</span>
and <span class="math notranslate nohighlight">\(U(x) = (2m/\hbar^2)V(x)\)</span>, becomes:</p>
<div class="math notranslate nohighlight">
\[\psi'' + (\varepsilon - U(x))\psi = 0\]</div>
<p><strong>Why O(dx⁴)?  The Numerov Advantage</strong></p>
<p>A standard central-difference second derivative has <span class="math notranslate nohighlight">\(O(dx^2)\)</span> local
truncation error:</p>
<div class="math notranslate nohighlight">
\[\psi''_i = \frac{\psi_{i+1} - 2\psi_i + \psi_{i-1}}{dx^2} + O(dx^2)\]</div>
<p>The Numerov method improves this by exploiting the structure of the
differential equation itself.  Starting from the exact Taylor expansion:</p>
<div class="math notranslate nohighlight">
\[\psi_{i+1} + \psi_{i-1} = 2\psi_i + dx^2 \psi''_i + \frac{dx^4}{12}
\psi''''_i + O(dx^6)\]</div>
<p>and noting that for the TISE <span class="math notranslate nohighlight">\(\psi'''' = (U-\varepsilon)^2\psi + O(dx^2)\)</span>,
the fourth-derivative term can be approximated to <span class="math notranslate nohighlight">\(O(dx^2)\)</span> by a second
finite difference of <span class="math notranslate nohighlight">\((U-\varepsilon)\psi\)</span>:</p>
<div class="math notranslate nohighlight">
\[\frac{dx^4}{12}\psi''''_i \approx \frac{dx^2}{12}
\left[f_{i+1}\psi_{i+1} - 2f_i\psi_i + f_{i-1}\psi_{i-1}\right]
+ O(dx^6)\]</div>
<p>where <span class="math notranslate nohighlight">\(f_i = U_i - \varepsilon\)</span>.  Substituting into the Taylor expansion
and rearranging gives the Numerov recurrence, which has a <strong>global truncation
error of</strong> <span class="math notranslate nohighlight">\(O(dx^4)\)</span> — two orders better than standard FD.</p>
<p><strong>Matrix Form (Generalized Eigenvalue Problem)</strong></p>
<p>Applying the Numerov recurrence to all <span class="math notranslate nohighlight">\(N-2\)</span> interior grid points
(with Dirichlet boundary conditions <span class="math notranslate nohighlight">\(\psi_0 = \psi_{N-1} = 0\)</span>) leads to:</p>
<div class="math notranslate nohighlight">
\[A\,\psi = \varepsilon\, B\,\psi\]</div>
<p>where:</p>
<div class="math notranslate nohighlight">
\[A = \underbrace{\frac{-1}{dx^2} M_{-2}}_{\text{kinetic}} +
    \underbrace{\frac{1}{12} M_{10}\, \mathrm{diag}(U)}_{\text{potential}}
\qquad
B = \frac{1}{12} M_{10}\]</div>
<p><span class="math notranslate nohighlight">\(M_{-2}\)</span> is the tridiagonal matrix with <span class="math notranslate nohighlight">\(-2\)</span> on the main diagonal
and <span class="math notranslate nohighlight">\(+1\)</span> on the first off-diagonals (the standard second-difference
stencil).  <span class="math notranslate nohighlight">\(M_{10}\)</span> is the tridiagonal matrix with <span class="math notranslate nohighlight">\(10\)</span> on the
main diagonal and <span class="math notranslate nohighlight">\(+1\)</span> on the first off-diagonals (the Numerov weight
matrix).  Both are <em>symmetric</em>.</p>
<p>After solving for <span class="math notranslate nohighlight">\(\varepsilon\)</span>, the physical energies are recovered as:</p>
<div class="math notranslate nohighlight">
\[E_n = \varepsilon_n \cdot \frac{\hbar^2}{2m} = \frac{\varepsilon_n}{f}
\qquad f = \frac{2m}{\hbar^2}\]</div>
</section>
<dl class="py class">
<dt class="sig sig-object py" id="src.core.solvers.BaseSolver">
<span class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></span><span class="sig-prename descclassname"><span class="pre">src.core.solvers.</span></span><span class="sig-name descname"><span class="pre">BaseSolver</span></span><a class="reference internal" href="_modules/src/core/solvers.html#BaseSolver"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.core.solvers.BaseSolver" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">ABC</span></code></p>
<p>Abstract base class defining the interface for all 1D TISE solvers.</p>
<p>Any numerical method that solves the Time-Independent Schrödinger Equation
— be it Matrix Numerov, Finite Element, or a Shooting Method — must
implement this contract.  High-level “Experiment” code depends <em>only</em> on
this interface, never on a concrete solver implementation.</p>
<p>This enforces the <strong>Dependency Inversion Principle</strong>: abstractions own the
policy; concrete solvers own the algorithm.  Swapping from Numerov to FEM
requires only a new subclass, with zero changes to any consumer.</p>
<p class="rubric">Example</p>
<p>Define and use a custom solver transparently:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">class</span><span class="w"> </span><span class="nc">ShootingSolver</span><span class="p">(</span><span class="n">BaseSolver</span><span class="p">):</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">solve</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">potential</span><span class="p">:</span> <span class="n">BasePotential</span><span class="p">,</span>
        <span class="n">n_states</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">20</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">],</span> <span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">]]:</span>
        <span class="o">...</span>  <span class="c1"># shooting-method implementation</span>

<span class="n">experiment</span><span class="p">:</span> <span class="n">BaseSolver</span> <span class="o">=</span> <span class="n">ShootingSolver</span><span class="p">()</span>
<span class="n">energies</span><span class="p">,</span> <span class="n">psi</span> <span class="o">=</span> <span class="n">experiment</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">InfiniteSquareWell</span><span class="p">())</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="src.core.solvers.BaseSolver.solve">
<span class="property"><span class="k"><span class="pre">abstractmethod</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">solve</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">potential</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#src.models.potentials.BasePotential" title="src.models.potentials.BasePotential"><span class="pre">BasePotential</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_states</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">20</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">float64</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">float64</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/src/core/solvers.html#BaseSolver.solve"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.core.solvers.BaseSolver.solve" title="Link to this definition"></a></dt>
<dd><p>Solves the 1D TISE and returns the lowest <code class="docutils literal notranslate"><span class="pre">n_states</span></code> eigenpairs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>potential</strong> – Any concrete <a class="reference internal" href="#src.models.potentials.BasePotential" title="src.models.potentials.BasePotential"><code class="xref py py-class docutils literal notranslate"><span class="pre">BasePotential</span></code></a>
subclass supplying <span class="math notranslate nohighlight">\(V(x)\)</span> and the spatial domain.</p></li>
<li><p><strong>n_states</strong> – Number of lowest-energy eigenvalues and eigenvectors to
compute.  Must be at least 1.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">energies</span></code> — 1D float64 array of shape <code class="docutils literal notranslate"><span class="pre">(n_states,)</span></code>
containing <span class="math notranslate nohighlight">\(E_n\)</span> in dimensionless units of <span class="math notranslate nohighlight">\(E_1\)</span>,
sorted in ascending order.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">wavefunctions</span></code> — 2D float64 array of shape
<code class="docutils literal notranslate"><span class="pre">(n_points,</span> <span class="pre">n_states)</span></code> where column <code class="docutils literal notranslate"><span class="pre">k</span></code> is
<span class="math notranslate nohighlight">\(\psi_k(x)\)</span>, normalised so that
<span class="math notranslate nohighlight">\(\int |\psi_k|^2\, dx = 1\)</span>.</p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>A tuple <code class="docutils literal notranslate"><span class="pre">(energies,</span> <span class="pre">wavefunctions)</span></code> where</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – If <code class="docutils literal notranslate"><span class="pre">n_states</span> <span class="pre">&lt;</span> <span class="pre">1</span></code>.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="src.core.solvers.NumerovSolver">
<span class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></span><span class="sig-prename descclassname"><span class="pre">src.core.solvers.</span></span><span class="sig-name descname"><span class="pre">NumerovSolver</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#src.models.config.NumericalConfig" title="src.models.config.NumericalConfig"><span class="pre">NumericalConfig</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/src/core/solvers.html#NumerovSolver"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.core.solvers.NumerovSolver" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#src.core.solvers.BaseSolver" title="src.core.solvers.BaseSolver"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseSolver</span></code></a></p>
<p>Service class that solves the 1D TISE via the Matrix Numerov method.</p>
<p>Encapsulates the full Numerov eigenvalue pipeline:
(1) auto-build the spatial grid from the potential’s own domain,
(2) assemble the symmetric generalised-eigenvalue matrices A and B,
(3) solve with <code class="docutils literal notranslate"><span class="pre">scipy.linalg.eigh</span></code> (optimised for real-symmetric</p>
<blockquote>
<div><p>positive-definite pencils),</p>
</div></blockquote>
<ol class="arabic simple" start="4">
<li><p>recover physical energies and normalise wavefunctions.</p></li>
</ol>
<p>The solver is <strong>closed for modification</strong> and <strong>open for extension</strong> via
any subclass of <a class="reference internal" href="#src.models.potentials.BasePotential" title="src.models.potentials.BasePotential"><code class="xref py py-class docutils literal notranslate"><span class="pre">BasePotential</span></code></a> — the
potential geometry is injected through <a class="reference internal" href="#src.core.solvers.NumerovSolver.solve" title="src.core.solvers.NumerovSolver.solve"><code class="xref py py-meth docutils literal notranslate"><span class="pre">solve()</span></code></a>, never hardcoded.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>config</strong> – Numerical discretisation parameters.  When <code class="docutils literal notranslate"><span class="pre">None</span></code>,
defaults are used (600 grid points, convergence tolerance 1e-4).</p>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="src.core.solvers.NumerovSolver.config">
<span class="sig-name descname"><span class="pre">config</span></span><a class="headerlink" href="#src.core.solvers.NumerovSolver.config" title="Link to this definition"></a></dt>
<dd><p>The injected <a class="reference internal" href="#src.models.config.NumericalConfig" title="src.models.config.NumericalConfig"><code class="xref py py-class docutils literal notranslate"><span class="pre">NumericalConfig</span></code></a>,
read-only after construction.</p>
</dd></dl>

<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">src.models</span><span class="w"> </span><span class="kn">import</span> <span class="n">InfiniteSquareWell</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">solver</span> <span class="o">=</span> <span class="n">NumerovSolver</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">energies</span><span class="p">,</span> <span class="n">wavefunctions</span> <span class="o">=</span> <span class="n">solver</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">InfiniteSquareWell</span><span class="p">(),</span> <span class="n">n_states</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># energies ≈ [1, 4, 9, 16, 25] in dimensionless E₁ units</span>
</pre></div>
</div>
<dl class="py property">
<dt class="sig sig-object py" id="id9">
<span class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">config</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#src.models.config.NumericalConfig" title="src.models.config.NumericalConfig"><span class="pre">NumericalConfig</span></a></span><a class="headerlink" href="#id9" title="Link to this definition"></a></dt>
<dd><p>The injected numerical parameters, read-only.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#src.models.config.NumericalConfig" title="src.models.config.NumericalConfig">NumericalConfig</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="src.core.solvers.NumerovSolver.solve">
<span class="sig-name descname"><span class="pre">solve</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">potential</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#src.models.potentials.BasePotential" title="src.models.potentials.BasePotential"><span class="pre">BasePotential</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_states</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">20</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">float64</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">float64</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/src/core/solvers.html#NumerovSolver.solve"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#src.core.solvers.NumerovSolver.solve" title="Link to this definition"></a></dt>
<dd><p>Solves the 1D TISE for the given potential and returns eigenpairs.</p>
<p>The method follows these steps:</p>
<ol class="arabic simple">
<li><p><strong>Auto-Grid</strong>: Calls <code class="docutils literal notranslate"><span class="pre">potential.get_domain()</span></code> to obtain
<span class="math notranslate nohighlight">\([x_{min}, x_{max}]\)</span> and builds a uniform grid of
<code class="docutils literal notranslate"><span class="pre">config.n_points</span></code> points.  The domain is set by the
<em>potential</em>, not by global constants.</p></li>
<li><p><strong>Matrix assembly</strong>: Constructs the symmetric generalised
matrices <span class="math notranslate nohighlight">\(A\)</span> and <span class="math notranslate nohighlight">\(B\)</span> from the Numerov recurrence
using only the <span class="math notranslate nohighlight">\(N-2\)</span> interior grid points (Dirichlet BCs).</p></li>
<li><p><strong>Solve</strong>: Calls <code class="docutils literal notranslate"><span class="pre">scipy.linalg.eigh(A,</span> <span class="pre">B,</span> <span class="pre">subset_by_index=...)</span></code>,
which is optimised for symmetric-positive-definite pencils and
returns eigenvalues in ascending order without post-sorting.</p></li>
<li><p><strong>Energy recovery</strong>: Converts dimensionless eigenvalues
<span class="math notranslate nohighlight">\(\varepsilon_n\)</span> to physical energies
<span class="math notranslate nohighlight">\(E_n = \varepsilon_n \hbar^2 / (2m)\)</span>.</p></li>
<li><p><strong>Normalisation</strong>: Calls <code class="xref py py-meth docutils literal notranslate"><span class="pre">_normalize()</span></code> on each wavefunction
so that <span class="math notranslate nohighlight">\(\int |\psi_n(x)|^2\, dx = 1\)</span>.</p></li>
</ol>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>potential</strong> – Any concrete <a class="reference internal" href="#src.models.potentials.BasePotential" title="src.models.potentials.BasePotential"><code class="xref py py-class docutils literal notranslate"><span class="pre">BasePotential</span></code></a>
subclass.  The solver reads <code class="docutils literal notranslate"><span class="pre">potential.config</span></code> for physical
constants and <code class="docutils literal notranslate"><span class="pre">potential.get_domain()</span></code> for the grid domain.</p></li>
<li><p><strong>n_states</strong> – Number of lowest eigenvalues/eigenvectors to compute.
Requesting fewer states is significantly faster for large grids
because <code class="docutils literal notranslate"><span class="pre">eigh</span></code> uses a divide-and-conquer LAPACK driver.
Defaults to 20.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">energies</span></code> is a 1D float64 array of shape <code class="docutils literal notranslate"><span class="pre">(n_states,)</span></code>
containing <span class="math notranslate nohighlight">\(E_n\)</span> in dimensionless units of <span class="math notranslate nohighlight">\(E_1\)</span>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">wavefunctions</span></code> is a 2D float64 array of shape
<code class="docutils literal notranslate"><span class="pre">(n_points,</span> <span class="pre">n_states)</span></code> where column <code class="docutils literal notranslate"><span class="pre">k</span></code> is
<span class="math notranslate nohighlight">\(\psi_k(x)\)</span>, normalised so that
<span class="math notranslate nohighlight">\(\int |\psi_k|^2\, dx = 1\)</span>.</p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>A tuple <code class="docutils literal notranslate"><span class="pre">(energies,</span> <span class="pre">wavefunctions)</span></code> where</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – If <code class="docutils literal notranslate"><span class="pre">n_states</span> <span class="pre">&lt;</span> <span class="pre">1</span></code> or if the grid has fewer than 3
    points (making a 0-sized interior impossible).</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p><strong>Symmetrisation of</strong> <span class="math notranslate nohighlight">\(A\)</span>: The potential term
<span class="math notranslate nohighlight">\((1/12) M_{10} \cdot \mathrm{diag}(U)\)</span> is not exactly
symmetric for spatially varying <span class="math notranslate nohighlight">\(U(x)\)</span>, because its
<span class="math notranslate nohighlight">\((i, j)\)</span> off-diagonal entry is <span class="math notranslate nohighlight">\(M_{10}[i,j] \cdot U_j\)</span>
while its transpose has <span class="math notranslate nohighlight">\(M_{10}[i,j] \cdot U_i\)</span>.  The
asymmetry at neighbouring nodes is <span class="math notranslate nohighlight">\(O(dx)\)</span>.  We symmetrise
<span class="math notranslate nohighlight">\(A\)</span> explicitly via <span class="math notranslate nohighlight">\(A \leftarrow (A + A^T)/2\)</span> before
passing it to <code class="docutils literal notranslate"><span class="pre">eigh</span></code>.  By first-order perturbation theory the
anti-symmetric part has zero quadratic form on real eigenvectors
(it is anti-Hermitian), so the eigenvalue error from this step is
at most <span class="math notranslate nohighlight">\(O(dx^2)\)</span> — well within the <span class="math notranslate nohighlight">\(10^{-3}\)</span> tolerance
required for all physics analyses in this project.</p>
</dd></dl>

</dd></dl>

</section>
</section>


           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2026, Pablo Sanchez, Juan Montoya.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>